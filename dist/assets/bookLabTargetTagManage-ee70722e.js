import{u as z,b as d,o as O,a as v,c as T,i as k,t as x,f as a,g as l,w as o,s as u,x as j,O as A,a8 as G,q as m,F as H,j as J,n as K,aR as P,N as Q,a2 as W,a3 as X,a0 as Y,$ as Z,ax as ee,ad as le}from"./index-8f9ccc2f.js";/* empty css                  */import{n as te,q as ae,r as oe,s as se,t as ne}from"./index-9020ea85.js";import{l as ie}from"./lodash-56abab90.js";/* empty css                   *//* empty css                       */const de={class:"p-[18px]"},re={class:"h-full mb-4"},ue={class:"text-xl"},ve={__name:"bookLabTargetTagManage",setup(me){const I=z(),p=d(I.params.bookId),y=d([]),V=d([]),i=d({title:"",visible:!1,isEdit:!1});d(!1);const c=d(null),n=d({id:null,bookId:p.value,targetId:null,name:"",ability:"",description:"",style:"",config:"",payload:"",keyNode:!1}),B=()=>{n.value={id:null,bookId:p.value,targetId:null,name:"",ability:"",description:"",style:"",config:"",payload:"",keyNode:!1}},D=d({name:[{required:!0,message:"请输入监测点名称",trigger:"blur"}],targetId:[{required:!0,message:"请选择监测点目标",trigger:"blur"}],ability:[{required:!1,message:"请输入监测点能力",trigger:"blur"}],description:[{required:!1,message:"请输入监测点描述",trigger:"blur"}]}),_=()=>{te(p.value).then(s=>{s.state==200?V.value=s.data:u.error(s.message)})},N=()=>{i.value.title="添加监测点",i.value.isEdit=!1,i.value.visible=!0},w=s=>{i.value.title="编辑监测点",i.value.isEdit=!0,i.value.visible=!0,console.log(s),n.value=ie.cloneDeep(s)},E=()=>{c.value.clearValidate(),i.value.visible=!1,i.value.title="",i.value.isEdit=!1,B()},C=async()=>{c.value.validate(s=>{i.value.isEdit?oe(n.value).then(e=>{e.state==200?(E(),_()):u.error(e.message)}):se(n.value).then(e=>{e.state==200?(E(),_()):u.error(e.message)})})},L=s=>{P.confirm(`确定要删除该监测点【${s.name}】吗？`,"提示",{type:"warning"}).then(async()=>{ne(s.id).then(e=>{e.state==200?(_(),u.success("删除成功")):u.error(e.message)})}).catch(()=>{})},q=()=>{ae(p.value).then(s=>{s.state==200?(console.log(s.data),y.value=s.data.targetList):u.error(s.message)})};return O(()=>{_(),q()}),(s,e)=>{const g=j,r=Q,U=A,h=W,F=X,f=Y,b=Z,$=ee,M=le,R=G;return v(),T("div",de,[k("div",re,[k("span",ue,"监测点管理 - 实验id: "+x(a(p)),1)]),k("div",null,[l(g,{type:"primary",onClick:N},{default:o(()=>e[7]||(e[7]=[m("添加监测点",-1)])),_:1,__:[7]}),l(U,{data:a(V),style:{width:"100%"},class:"mt-4"},{default:o(()=>[l(r,{prop:"id",label:"ID",width:"80"}),l(r,{prop:"name",label:"监测点名称",width:"200"}),l(r,{prop:"keyNode",label:"关键节点",width:"100"},{default:o(({row:t})=>[m(x(t.keyNode?"是":"否"),1)]),_:1}),l(r,{prop:"description",label:"描述",width:"200"}),l(r,{prop:"targetName",label:"课程目标"}),l(r,{label:"操作",width:"200"},{default:o(({row:t})=>[l(g,{size:"small",onClick:S=>w(t)},{default:o(()=>e[8]||(e[8]=[m("编辑",-1)])),_:2,__:[8]},1032,["onClick"]),l(g,{size:"small",type:"danger",onClick:S=>L(t)},{default:o(()=>e[9]||(e[9]=[m("删除",-1)])),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l(R,{title:a(i).title,modelValue:a(i).visible,"onUpdate:modelValue":e[6]||(e[6]=t=>a(i).visible=t),width:"800px"},{footer:o(()=>[l(g,{onClick:e[5]||(e[5]=t=>a(i).visible=!1)},{default:o(()=>e[10]||(e[10]=[m("取消",-1)])),_:1,__:[10]}),l(g,{type:"primary",onClick:C},{default:o(()=>e[11]||(e[11]=[m("确定",-1)])),_:1,__:[11]})]),default:o(()=>[l(M,{model:a(n),ref_key:"formRef",ref:c,rules:a(D),"label-width":"100px"},{default:o(()=>[l(f,{label:"课程目标",prop:"targetId"},{default:o(()=>[l(F,{modelValue:a(n).targetId,"onUpdate:modelValue":e[0]||(e[0]=t=>a(n).targetId=t),style:{width:"100%"}},{default:o(()=>[(v(!0),T(H,null,J(a(y),t=>(v(),K(h,{key:t.id,label:t.name,value:t.id,title:t.name},null,8,["label","value","title"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"监测点名称",prop:"name"},{default:o(()=>[l(b,{modelValue:a(n).name,"onUpdate:modelValue":e[1]||(e[1]=t=>a(n).name=t),placeholder:"监测点名称"},null,8,["modelValue"])]),_:1}),l(f,{label:"能力"},{default:o(()=>[l(b,{modelValue:a(n).ability,"onUpdate:modelValue":e[2]||(e[2]=t=>a(n).ability=t),placeholder:"能力"},null,8,["modelValue"])]),_:1}),l(f,{label:"描述",prop:"description"},{default:o(()=>[l(b,{modelValue:a(n).description,"onUpdate:modelValue":e[3]||(e[3]=t=>a(n).description=t),placeholder:"监测点描述"},null,8,["modelValue"])]),_:1}),l(f,{label:"关键节点",prop:"keyNode"},{default:o(()=>[l($,{modelValue:a(n).keyNode,"onUpdate:modelValue":e[4]||(e[4]=t=>a(n).keyNode=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}};export{ve as default};
