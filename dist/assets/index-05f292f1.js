import{h as X,e as z,a as s,c as l,i as e,g as n,K as L,d as U,b as h,o as Y,t as _,q as G,k as p,av as re,s as P,a7 as ye,aZ as se,f as x,F as N,j as I,aV as ie,n as q,$ as oe,w as O,v as he,y as ge,_ as le,a9 as ce,ap as de,D as we,L as ke,a2 as ue,a3 as me,x as $e,z as pe,W as Ce,u as Se,H as Te,bc as Ve,bd as je}from"./index-8f9ccc2f.js";import{a as Ee}from"./projectStudent-4ff3f16f.js";import{t as T}from"./stuLab-819536eb.js";/* empty css                   */import{_ as Oe}from"./logo-629560f5.js";import"./browser-19b77043.js";import"./marked.esm-fed877e7.js";import"./katex-4b21be29.js";import"./purify.es-9c590e79.js";function ne(r){return X({url:"/emdv4/task/detail/pst_by_id",method:"GET",params:{pstId:r}})}function Ne(r,c){return X({url:"/emdv4/task/detail/pst_by_psid_ptnum",method:"GET",params:{projectStudentId:r,projectTaskNum:c}})}function Ie(r,c){return X({url:"/emdv4/task/detail/checked/score/"+r,method:"POST",params:{score:c}})}function qe(r){return X({url:"/emdv4/task/detail/checked/score/weighting",method:"POST",data:r})}function Re(r){return X({url:"/emdv4/project/detail/pt_by_id",method:"GET",params:{projectTaskId:r}})}const Ae={key:0},Le={key:0,class:"font-medium text-green-800 mb-1"},Be={key:1,class:"font-medium text-red-800 mb-1"},Pe={key:1,class:"mt-2 p-3 rounded answer-warning"},xe={__name:"analysis",props:{comp:Object},setup(r){return(c,a)=>{const u=z("font-awesome-icon");return r.comp.payload.result.showCheck?(s(),l("div",Ae,[e("div",{class:L(["mt-2 p-3 rounded",r.comp.score>0?"answer-correct":"answer-error"])},[r.comp.score>0?(s(),l("div",Le,[n(u,{icon:"fas fa-check-circle",class:"text-green-600 mr-1"}),a[0]||(a[0]=e("span",{class:"text-green-800"},"回答正确！",-1))])):(s(),l("div",Be,[n(u,{icon:"fa-solid fa-xmark",class:"text-red-600 mr-1"}),a[1]||(a[1]=e("span",{class:"text-red-800"},"回答错误！",-1))])),n(T,{content:r.comp.payload.question.analysis},null,8,["content"])],2)])):(s(),l("div",Pe,[n(u,{icon:"fa-solid fa-circle-exclamation",class:"text-yellow-600 mr-1"}),a[2]||(a[2]=e("span",{class:"text-yellow-800"},"学生未作回答！",-1))]))}}};function Ue(r,c){return X({url:"/emdv4/component/check/score/"+r,method:"POST",params:{score:c}})}const We={key:0,class:"flex items-center justify-between mt-4"},He={class:"flex flex-row items-center"},Me={class:"flex flex-row items-center"},K=U({__name:"scoreReadOver",props:{component:Object},setup(r){const c=r,a=h(),u=(b,d)=>{Ue(b,d).then(t=>{t.state==200?re.emit("checkScoreChange"):P.error("修改评分错误："+t.message)})};return Y(()=>{a.value=c.component}),(b,d)=>{const t=ye;return a.value?(s(),l("div",We,[e("div",He,[d[2]||(d[2]=e("div",null," AI评分： ",-1)),e("div",{class:L(a.value.aiScore>=a.value.totalScore?"text-green-600":"text-red-600")},_(a.value.aiScore)+"分 ",3)]),e("div",Me,[d[3]||(d[3]=e("div",null,"修改评分：",-1)),e("div",null,[n(t,{modelValue:a.value.score,"onUpdate:modelValue":d[0]||(d[0]=f=>a.value.score=f),min:0,max:a.value.totalScore,"controls-position":"right",onChange:d[1]||(d[1]=f=>u(a.value.id,a.value.score)),style:{"--el-input-focus-border":"#020617"}},null,8,["modelValue","max"]),G(" / "+_(a.value.totalScore)+"分 ",1)])])])):p("",!0)}}}),De={class:"p-4 bg-gray-50 rounded-lg border-l-4 border-blue-500"},Ge={class:"space-y-2 mb-3"},ze={key:0,class:"p-2 border rounded bg-green-50 border-green-200"},Qe={class:"flex items-center space-x-2"},Ye={class:"flex flex-row items-center"},Je={class:"mr-2"},Fe={key:1,class:"p-2 border rounded bg-yellow-50 border-yellow-200"},Xe={class:"flex items-center space-x-2"},Ke={class:"flex flex-row items-center"},Ze={class:"mr-2"},et={key:2,class:"p-2 border rounded bg-red-50 border-red-200"},tt={class:"flex items-center space-x-2"},st={class:"flex flex-row items-center"},ot={class:"mr-2"},lt={key:3,class:"p-2 border rounded bg-white border-gray-200"},nt={class:"flex items-center space-x-2"},at={class:"mr-2"},fe=U({__name:"choice",props:{index:Number,comp:Object,sectionDisabled:Boolean},setup(r){const c=r,a=se(()=>{let u="";return c.index>0&&(u=c.index+"."),u+c.comp.payload.question.question});return(u,b)=>{const d=z("font-awesome-icon");return s(),l("div",De,[n(T,{content:x(a)},null,8,["content"]),e("div",Ge,[(s(!0),l(N,null,I(r.comp.payload.question.options,t=>(s(),l("div",null,[t.label==r.comp.payload.question.answer&&t.label==r.comp.payload.stuAnswer.answer?(s(),l("div",ze,[e("div",Qe,[n(d,{icon:"fas fa-user-check",class:"text-blue-500 mr-1"}),n(d,{icon:"fas fa-check",class:"text-green-500"}),e("div",Ye,[e("span",Je,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])])])):t.label==r.comp.payload.question.answer&&t.label!=r.comp.payload.stuAnswer.answer?(s(),l("div",Fe,[e("div",Xe,[n(d,{icon:"fas fa-check",class:"text-green-500"}),e("div",Ke,[e("span",Ze,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])])])):t.label!=r.comp.payload.question.answer&&t.label==r.comp.payload.stuAnswer.answer?(s(),l("div",et,[e("div",tt,[n(d,{icon:"fas fa-user-check",class:"text-blue-500 mr-1"}),n(d,{icon:"fas fa-times",class:"text-red-500"}),e("div",st,[e("span",ot,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])])])):(s(),l("div",lt,[e("div",nt,[e("span",at,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])]))]))),256))]),n(xe,{comp:r.comp},null,8,["comp"]),n(K,{component:r.comp},null,8,["component"])])}}}),rt={class:"p-4 bg-gray-50 rounded-lg border-l-4 border-blue-500"},it={class:"space-y-2 mb-3"},ct={key:0,class:"p-2 border rounded bg-green-50 border-green-200"},dt={class:"flex items-center space-x-2"},ut={class:"flex flex-row items-center"},mt={class:"mr-2"},pt={key:1,class:"p-2 border rounded bg-yellow-50 border-yellow-200"},xt={class:"flex items-center space-x-2"},ft={class:"flex flex-row items-center"},_t={class:"mr-2"},bt={key:2,class:"p-2 border rounded bg-red-50 border-red-200"},vt={class:"flex items-center space-x-2"},yt={class:"flex flex-row items-center"},ht={class:"mr-2"},gt={key:3,class:"p-2 border rounded bg-white border-gray-200"},wt={class:"flex items-center space-x-2"},kt={class:"mr-2"},_e=U({__name:"multipleChoice",props:{index:Number,comp:Object},setup(r){const c=r,a=se(()=>{let u="";return c.index>0&&(u=c.index+"."),u+c.comp.payload.question.question});return(u,b)=>{const d=z("font-awesome-icon");return s(),l("div",rt,[n(T,{content:x(a)},null,8,["content"]),e("div",it,[(s(!0),l(N,null,I(r.comp.payload.question.options,t=>(s(),l("div",null,[r.comp.payload.question.answerOption.includes(t.label)&&r.comp.payload.stuAnswer.answer.includes(t.label)?(s(),l("div",ct,[e("div",dt,[n(d,{icon:"fas fa-user-check",class:"text-blue-500 mr-1"}),n(d,{icon:"fas fa-check",class:"text-green-500"}),e("div",ut,[e("span",mt,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])])])):r.comp.payload.question.answerOption.includes(t.label)&&!r.comp.payload.stuAnswer.answer.includes(t.label)?(s(),l("div",pt,[e("div",xt,[n(d,{icon:"fas fa-check",class:"text-green-500"}),e("div",ft,[e("span",_t,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])])])):!r.comp.payload.question.answerOption.includes(t.label)&&r.comp.payload.stuAnswer.answer.includes(t.label)?(s(),l("div",bt,[e("div",vt,[n(d,{icon:"fas fa-user-check",class:"text-blue-500 mr-1"}),n(d,{icon:"fas fa-times",class:"text-red-500"}),e("div",yt,[e("span",ht,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])])])):(s(),l("div",gt,[e("div",wt,[e("span",kt,_(t.label)+".",1),n(T,{content:t.value},null,8,["content"])])]))]))),256))]),n(xe,{comp:r.comp},null,8,["comp"]),n(K,{component:r.comp},null,8,["component"])])}}}),$t=U({__name:"selectGroup",props:{block:Object},emits:["complete"],setup(r,{emit:c}){const a=r,u=c,b=h([]),d=()=>{let f=[];for(let v=0;v<a.block.components.length;v++){let g=a.block.components[v];typeof g.payload=="string"&&(g.payload=JSON.parse(g.payload)),f.push(g)}f=f.sort((v,g)=>v.order-g.order),b.value=f},t=()=>{if(a.block.status==0&&!a.block.hasChildren){let g=a.block.components,w=g.length,V=0;for(let m=0;m<w;m++)g[m].status==1&&V++;V==w&&u("complete",1)}};return ie(()=>{d(),t()}),(f,v)=>(s(!0),l(N,null,I(x(b),(g,w)=>(s(),l("div",{key:w,class:L(w!=0?"mt-8":"")},[g.type=="CHOICE"&&g.needCalculate?(s(),q(fe,{key:0,index:w+1,comp:g},null,8,["index","comp"])):p("",!0),g.type=="MULTIPLECHOICE"&&g.needCalculate?(s(),q(_e,{key:1,index:w+1,comp:g},null,8,["index","comp"])):p("",!0)],2))),128))}}),Ct={key:0},St={key:0,class:"font-medium text-green-800 mb-1"},Tt={key:1,class:"font-medium text-red-800 mb-1"},Vt={key:1,class:"mt-2 p-3 rounded answer-warning"},jt={__name:"analysisQa",props:{comp:Object},setup(r){return(c,a)=>{const u=z("font-awesome-icon");return r.comp.payload.result.showCheck?(s(),l("div",Ct,[e("div",{class:L(["mt-2 p-3 rounded",r.comp.score==r.comp.totalScore?"answer-correct":"answer-error"])},[r.comp.score==r.comp.totalScore?(s(),l("div",St,[n(u,{icon:"fas fa-check-circle",class:"text-green-600 mr-1"}),a[0]||(a[0]=e("span",{class:"text-green-800"},"回答正确！",-1))])):(s(),l("div",Tt,[n(u,{icon:"fa-solid fa-xmark",class:"text-red-600 mr-1"}),a[1]||(a[1]=e("span",{class:"text-red-800"},"回答错误！",-1))])),n(T,{content:r.comp.payload.question.analysis},null,8,["content"])],2)])):(s(),l("div",Vt,[n(u,{icon:"fa-solid fa-circle-exclamation",class:"text-yellow-600 mr-1"}),a[2]||(a[2]=e("span",{class:"text-yellow-800"},"学生未作回答！",-1))]))}}},Et={class:"ist-theam p-4 bg-gray-50 rounded-lg border-l-4 border-blue-500 scroll-mt-[80px]",tabindex:"0"},Ot={class:"scroll-mt-[80px]"},Nt=U({__name:"qa",props:{index:Number,comp:Object},setup(r){return Y(()=>{}),(c,a)=>{const u=oe;return s(),l("div",Et,[n(T,{content:r.comp.payload.question.question},null,8,["content"]),e("div",Ot,[n(u,{class:"w-full",type:"textarea",autosize:{minRows:4},placeholder:"作答区域",readonly:"",modelValue:r.comp.payload.stuAnswer.answer,"onUpdate:modelValue":a[0]||(a[0]=b=>r.comp.payload.stuAnswer.answer=b)},null,8,["modelValue"])]),n(jt,{comp:r.comp},null,8,["comp"]),n(K,{component:r.comp},null,8,["component"])])}}}),It={class:"ist-theam border my-8 p-8"},qt={key:0},Rt={key:1,class:"w-full"},At={key:0,class:"w-full bg-green-100 p-4 border-l-4 border-green-500"},Lt={class:"mb-4 flex flex-row items-center text-green-900 text-xl"},Bt={key:1,class:"w-full bg-red-100 p-4 border-l-4 border-red-500"},Pt={class:"mb-4 flex flex-row items-center text-red-900 text-xl"},Ut={class:"mb-4 text-red-700 text-xl"},Wt=U({__name:"circuit",props:{blockVo:Object,status:Number,comp:Object,index:Number},setup(r){h(),h(),h(!1),h(),h();const c=h({full_mark:5,score:null,remark:""});return(a,u)=>{const b=he,d=z("font-awesome-icon"),t=ge;return s(),l("div",It,[u[4]||(u[4]=e("h2",{name:"电路连线检测"},"电路连线检测",-1)),n(t,{class:"my-4"},{default:O(()=>[n(b,{span:6,class:"my-4 flex flex-row justify-center items-center"},{default:O(()=>u[0]||(u[0]=[e("button",{class:"w-full btn bg-blue-500 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md flex justify-center items-center mx-8"}," 电路检查 ",-1)])),_:1,__:[0]}),n(b,{span:18,class:"my-4 flex flex-row justify-center items-center"},{default:O(()=>[x(c).score==null?(s(),l("div",qt)):(s(),l("div",Rt,[x(c).score==x(c).full_mark?(s(),l("div",At,[e("div",Lt,[n(d,{icon:"fa-solid fa-check-double",class:"mr-4"}),u[1]||(u[1]=e("span",null," 电路连接正确！ ",-1))]),u[2]||(u[2]=e("div",{class:"mb-4 text-green-700 text-xl"}," 所有连接点均正确，您可以继续进行操作。 ",-1))])):p("",!0),x(c).score<x(c).full_mark?(s(),l("div",Bt,[e("div",Pt,[n(d,{icon:"fa-solid fa-xmark",class:"mr-4"}),u[3]||(u[3]=e("span",null," 电路连接存在问题！ ",-1))]),e("div",Ut,_(x(c).remark),1)])):p("",!0)]))]),_:1})]),_:1}),n(K,{component:r.comp},null,8,["component"])])}}});const Ht=le(Wt,[["__scopeId","data-v-f131042d"]]),Mt={key:0,class:"ist-theam scroll-mt-[80px] my-4 rounded-lg border-l-4 border-blue-500"},Dt={key:0},Gt=["colspan"],zt={class:"flex flex-row justify-between"},Qt={class:"text-blue-400"},Yt=["id"],Jt={key:0},Ft={key:1},Xt={key:0},Kt={key:0},Zt={class:"text-red-400"},es={key:1,class:"text-emerald-400"},ts={key:1},ss=U({__name:"emdV4Table",props:{comp:Object,status:{type:Boolean,default:!1}},setup(r){const c=r,a=h();return Y(()=>{a.value=c.comp.payload}),(u,b)=>{var g;const d=z("font-awesome-icon"),t=ce,f=oe,v=de;return(g=x(a))!=null&&g.table?(s(),l("div",Mt,[e("table",null,[e("thead",null,[x(a).table.tableName?(s(),l("tr",Dt,[e("th",{colspan:x(a).table.tableHeader.length},[n(T,{content:x(a).table.tableName},null,8,["content"])],8,Gt)])):p("",!0),e("tr",null,[(s(!0),l(N,null,I(x(a).table.tableHeader,(w,V)=>(s(),l("th",null,[e("div",zt,[n(T,{content:w.value},null,8,["content"]),w.question?(s(),q(t,{key:0,content:"本列单元格数据填写后自动检查",placement:"top",effect:"light"},{default:O(()=>[e("button",Qt,[n(d,{icon:"fa-solid fa-circle-info"})])]),_:1})):p("",!0)])]))),256))])]),e("tbody",null,[(s(!0),l(N,null,I(x(a).table.tableRow,(w,V)=>(s(),l("tr",null,[(s(!0),l(N,null,I(x(a).table.tableRow[V],(m,$)=>{var W,H;return s(),l("td",null,[m.isNeedInput?(s(),l("div",{key:0,id:m.id,class:"flex flex-row justify-between items-center"},[e("div",{class:L(x(a).table.tableHeader[$].question?"w-[calc(100%-40px)]":"")},[m.isAutoGet?(s(),l("div",Jt,[n(f,{readonly:"",modelValue:m.stuVlaue,"onUpdate:modelValue":R=>m.stuVlaue=R},{append:O(()=>b[0]||(b[0]=[e("button",{class:L("text-gay-500 cursor-not-allowed"),disabled:""},"获取",-1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])):(s(),l("div",Ft,[n(f,{modelValue:m.stuVlaue,"onUpdate:modelValue":R=>m.stuVlaue=R,readonly:""},null,8,["modelValue","onUpdate:modelValue"])]))],2),x(a).table.tableHeader[$].question?(s(),l("div",Xt,[m.stuVlaue?(s(),l("div",Kt,[((W=m.result)==null?void 0:W.score)==0?(s(),q(v,{key:0,placement:"top-start",width:200,trigger:"hover"},{reference:O(()=>[e("button",Zt,[n(d,{icon:"fa-solid fa-circle-exclamation"})])]),default:O(()=>[n(T,{content:x(a).table.tableHeader[$].question.hintWhenWrong},null,8,["content"])]),_:2},1024)):((H=m.result)==null?void 0:H.score)>0?(s(),l("button",es,[n(d,{icon:"fa-solid fa-circle-check"})])):p("",!0)])):p("",!0)])):p("",!0)],8,Yt)):(s(),l("div",ts,[n(T,{content:m.value},null,8,["content"])]))])}),256))]))),256))])]),n(K,{component:r.comp},null,8,["component"])])):p("",!0)}}}),os={class:"rounded-lg border-l-4 border-blue-500 p-2"},ls={key:0,class:"ist-theam scroll-mt-[80px] my-4"},ns={key:0},as=["colspan"],rs={class:"flex flex-row justify-between"},is={class:"text-blue-400"},cs=["id"],ds={key:0},us={key:1},ms={key:0},ps={key:0},xs={class:"text-red-400"},fs={key:1,class:"text-emerald-400"},_s={key:1},bs={class:"flex justify-end items-center"},vs={class:"chart-option-item"},ys={class:"chart-option-item"},hs={class:"chart-option-item"},gs=U({__name:"tracneline",props:{index:Number,comp:Object},setup(r){const c=r,a=h();a.value=c.comp.payload.tracneline;const u=se(()=>c.comp.payload.table.col),b=se(()=>c.comp.status==0),d=h(null);let t=null,f=null;const v=()=>{!b.value&&t==null&&d.value&&(t=ke(d.value),f=new ResizeObserver(V=>{for(let m of V){const{width:$,height:W}=m.contentRect;$>0&&W>0&&t&&t.resize()}}),f.observe(d.value))},g=()=>{if(b.value){P.warning("`"+w.value.table.tableName+"` 数据不完整，无法完成绘图");return}let V=c.comp.payload.tracneline.coordinateIsLog,m=c.comp.payload.table,$=m.tableRow,W=m.row,H=m.col,R=[];for(let E=0;E<W;E++){let C=[];for(let S=0;S<H;S++){let J=+$[E][S].stuVlaue;C.push(J)}R.push(C)}let A=a.value,M=A.xIndex-1,D=A.yIndex-1;A.order==="x"?R.sort((E,C)=>E[M]-C[M]):A.order==="y"&&R.sort((E,C)=>E[D]-C[D]);let Q=[];for(let E=0;E<H;E++)Q.push(`列${E+1}`);let j=[Q,...R];if(v(),t){const E=V?"log":"value",C=V?"log":"value";t.setOption({title:{show:!1,text:""},dataset:{source:j},xAxis:{name:"x 轴",type:E},yAxis:{name:"y 轴",type:C},series:[{type:"line",smooth:!0,encode:{x:M,y:D}}]})}},w=h();return Y(()=>{w.value=c.comp.payload}),Y(()=>{v(),g()}),we(()=>{f&&f.disconnect(),t&&t.dispose()}),(V,m)=>{var Q;const $=z("font-awesome-icon"),W=ce,H=oe,R=de,A=ue,M=me,D=$e;return s(),l("div",os,[(Q=x(w))!=null&&Q.table?(s(),l("div",ls,[e("table",null,[e("thead",null,[x(w).table.tableName?(s(),l("tr",ns,[e("th",{colspan:x(w).table.tableHeader.length},[n(T,{content:x(w).table.tableName},null,8,["content"])],8,as)])):p("",!0),e("tr",null,[(s(!0),l(N,null,I(x(w).table.tableHeader,(j,E)=>(s(),l("th",null,[e("div",rs,[n(T,{content:j.value},null,8,["content"]),j.question?(s(),q(W,{key:0,content:"本列单元格数据填写后自动检查",placement:"top",effect:"light"},{default:O(()=>[e("button",is,[n($,{icon:"fa-solid fa-circle-info"})])]),_:1})):p("",!0)])]))),256))])]),e("tbody",null,[(s(!0),l(N,null,I(x(w).table.tableRow,(j,E)=>(s(),l("tr",null,[(s(!0),l(N,null,I(x(w).table.tableRow[E],(C,S)=>{var J,ee;return s(),l("td",null,[C.isNeedInput?(s(),l("div",{key:0,id:C.id,class:"flex flex-row justify-between items-center"},[e("div",{class:L(x(w).table.tableHeader[S].question?"w-[calc(100%-40px)]":"")},[C.isAutoGet?(s(),l("div",ds,[n(H,{readonly:"",modelValue:C.stuVlaue,"onUpdate:modelValue":Z=>C.stuVlaue=Z},{append:O(()=>m[3]||(m[3]=[e("button",{class:L("text-gay-500 cursor-not-allowed"),disabled:""},"获取",-1)])),_:2},1032,["modelValue","onUpdate:modelValue"])])):(s(),l("div",us,[n(H,{modelValue:C.stuVlaue,"onUpdate:modelValue":Z=>C.stuVlaue=Z,readonly:""},null,8,["modelValue","onUpdate:modelValue"])]))],2),x(w).table.tableHeader[S].question?(s(),l("div",ms,[C.stuVlaue?(s(),l("div",ps,[((J=C.result)==null?void 0:J.score)==0?(s(),q(R,{key:0,placement:"top-start",width:200,trigger:"hover"},{reference:O(()=>[e("button",xs,[n($,{icon:"fa-solid fa-circle-exclamation"})])]),default:O(()=>[n(T,{content:x(w).table.tableHeader[S].question.hintWhenWrong},null,8,["content"])]),_:2},1024)):((ee=C.result)==null?void 0:ee.score)>0?(s(),l("button",fs,[n($,{icon:"fa-solid fa-circle-check"})])):p("",!0)])):p("",!0)])):p("",!0)],8,cs)):(s(),l("div",_s,[n(T,{content:C.value},null,8,["content"])]))])}),256))]))),256))])])])):p("",!0),e("div",bs,[e("div",vs,[m[4]||(m[4]=e("span",null,"X轴：",-1)),n(M,{modelValue:x(a).xIndex,"onUpdate:modelValue":m[0]||(m[0]=j=>x(a).xIndex=j),placeholder:"选择横轴",disabled:""},{default:O(()=>[(s(!0),l(N,null,I(x(u),j=>(s(),q(A,{label:`第 ${j} 列`,value:j},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),e("div",ys,[m[5]||(m[5]=e("span",null,"Y轴：",-1)),n(M,{modelValue:x(a).yIndex,"onUpdate:modelValue":m[1]||(m[1]=j=>x(a).yIndex=j),placeholder:"选择纵轴",disabled:""},{default:O(()=>[(s(!0),l(N,null,I(x(u),j=>(s(),q(A,{label:`第 ${j} 列`,value:j},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),e("div",hs,[m[6]||(m[6]=e("span",null,"连线顺序：",-1)),n(M,{modelValue:x(a).order,"onUpdate:modelValue":m[2]||(m[2]=j=>x(a).order=j),placeholder:"选择连线顺序",disabled:""},{default:O(()=>[n(A,{label:"表格数据顺序",value:""}),n(A,{label:"沿X轴方向",value:"x"}),n(A,{label:"沿Y轴方向",value:"y"})]),_:1},8,["modelValue"])]),n(D,{type:"primary",size:"small",onClick:g},{default:O(()=>m[7]||(m[7]=[G("绘图",-1)])),_:1,__:[7]})]),e("div",{ref_key:"chartRef",ref:d,class:"border mt-4",style:{height:"400px"}},null,512),n(K,{component:r.comp},null,8,["component"])])}}});const ws=le(gs,[["__scopeId","data-v-0c3e1a8c"]]),ks=U({__name:"commonGroup",props:{block:Object},setup(r){const c=r,a=h([]),u=()=>{var d;let b=[];for(let t=0;t<((d=c.block.components)==null?void 0:d.length);t++){let f=c.block.components[t];typeof f.payload=="string"&&(f.payload=JSON.parse(f.payload)),b.push(f)}b=b.sort((t,f)=>t.order-f.order),a.value=b};return ie(()=>{u()}),(b,d)=>(s(!0),l(N,null,I(a.value,(t,f)=>(s(),l("div",{key:f,class:L(f!=0?"mt-8":"")},[t.type=="QA"&&t.needCalculate?(s(),q(Nt,{key:0,comp:t,index:f},null,8,["comp","index"])):p("",!0),t.type=="MULTIPLECHOICE"&&t.needCalculate?(s(),q(_e,{key:1,comp:t},null,8,["comp"])):p("",!0),t.type=="CHOICE"&&t.needCalculate?(s(),q(fe,{key:2,comp:t},null,8,["comp"])):p("",!0),t.type=="TABLE"&&t.needCalculate?(s(),q(ss,{key:3,index:f,comp:t},null,8,["index","comp"])):p("",!0),t.type=="CIRCUIT"&&t.needCalculate?(s(),q(Ht,{key:4,index:f,comp:t},null,8,["index","comp"])):p("",!0),t.type=="TRACELINE"&&t.needCalculate?(s(),q(ws,{key:5,index:f,comp:t},null,8,["index","comp"])):p("",!0)],2))),128))}}),$s={key:0,class:"book-lab-catalog-tree"},Cs={key:0,class:"components-content"},Ss={key:0},Ts={key:1},Vs={key:1},js={name:"BookLabRecursion"},Es=U({...js,props:{treeData:{type:Array,required:!0,default:()=>[]}},setup(r){const c=r,a=h();return pe(c.treeData,u=>{a.value=u}),Y(()=>{a.value=c.treeData}),(u,b)=>{const d=z("BookLabRecursion");return x(a)!=null?(s(),l("div",$s,[(s(!0),l(N,null,I(x(a),t=>(s(),l("div",{key:t.id,class:"catalog-node"},[!t.hasChildren&&t.components!=null&&t.components.length>0?(s(),l("div",Cs,[t.type=="commonGroup"?(s(),l("div",Ss,[n(ks,{block:t},null,8,["block"])])):p("",!0),t.type=="selectGroup"?(s(),l("div",Ts,[n($t,{block:t},null,8,["block"])])):p("",!0)])):p("",!0),t.hasChildren?(s(),l("div",Vs,[n(d,{"tree-data":t.children},null,8,["tree-data"])])):p("",!0)]))),128))])):p("",!0)}}}),ae=r=>r?Ce(r).format("YYYY-MM-DD HH:mm"):"--",Os={class:"mt-16 border-t pt-8 pb-16"},Ns={class:"max-w-4xl mx-auto text-center"},Is={class:"flex items-center justify-center mb-6"},qs={class:"text-xl font-bold text-gray-800"},Rs=U({__name:"footer",props:{name:String},setup(r){return(c,a)=>(s(),l("footer",Os,[e("div",Ns,[e("div",Is,[a[0]||(a[0]=e("img",{src:Oe,alt:"IECUBE",class:"w-12 h-12 mr-4"},null,-1)),e("h2",qs,_(r.name),1)]),a[1]||(a[1]=e("div",{class:"text-sm text-gray-500 mt-6"},[e("p",null,"作者：北京曾益慧创科技有限公司"),e("p",null,"版权所有 © 2025 北京曾益慧创科技有限公司 保留所有权利。")],-1))])]))}}),As={class:"bg-gray-50 min-h-screen"},Ls={class:"bg-white border-b border-gray-200 sticky top-0 z-50"},Bs={class:"max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8"},Ps={class:"flex justify-between items-center h-20"},Us={class:"flex items-center space-x-4"},Ws={class:"flex items-center space-x-2"},Hs={class:"flex items-center space-x-4"},Ms={key:0,class:"flex items-center space-x-2"},Ds={class:"flex justify-between w-full space-x-6"},Gs={class:"flex items-center space-x-2"},zs={class:"w-full h-full min-h-screen"},Qs={class:"max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 py-6 flex gap-6"},Ys={class:"min-w-[72%] max-w-[72%]"},Js={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 mb-6 fade-in"},Fs={class:"flex items-center justify-between"},Xs={class:"flex items-center space-x-6"},Ks={class:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-lg"},Zs={class:"flex flex-col space-y-4"},eo={class:"flex flex-row space-x-4"},to={class:"text-xl font-semibold text-gray-900"},so={class:"text-lg text-gray-900"},oo={class:"text-sm text-gray-500"},lo={class:"flex items-center space-x-6"},no={key:0,class:"text-right flex flex-col space-y-4"},ao={class:"text-sm font-medium text-gray-900"},ro={class:"text-right flex flex-col space-y-4"},io={key:0,class:"inline-flex items-center px-2.5 rounded-full text-sm font-medium bg-red-100 text-red-800"},co={key:1,class:"inline-flex items-center px-2.5 rounded-full text-sm font-medium bg-green-100 text-green-800"},uo={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6"},mo={class:"flex border-b border-gray-200"},po=["onClick"],xo={key:2,class:"bg-white rounded-xl shadow-sm border border-gray-200 fade-in p-6"},fo={class:"flex items-center justify-between mb-4"},_o={class:"text-lg font-semibold text-gray-900"},bo={class:"text-sm text-gray-500"},vo={class:"w-[28%]"},yo={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6 fade-in"},ho={class:"flex items-center justify-between mb-4"},go={key:0,class:"space-y-4"},wo={class:"space-y-4"},ko={class:"flex items-center justify-between"},$o={class:"flex items-center space-x-2"},Co={class:"text-sm text-gray-600"},So={key:0,class:"text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded-full"},To={class:"flex items-center space-x-2"},Vo={class:"text-lg font-semibold text-gray-900"},jo={class:"text-lg text-gray-500"},Eo={class:"w-full bg-gray-200 rounded-full h-2"},Oo={class:"border-t pt-4"},No={class:"flex items-center justify-between"},Io={class:"flex items-center space-x-2"},qo={class:"text-2xl font-bold text-indigo-600"},Ro={class:"mt-2 flex items-center justify-between"},Ao={key:0,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800"},Lo={key:1,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800"},Bo={key:2,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-sky-100 text-sky-800"},Po={key:3,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800"},Uo={key:4,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-lime-100 text-lime-800"},Wo={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 fade-in"},Ho={class:"space-y-3"},Mo={class:"flex items-center justify-between text-sm"},Do={class:"font-medium text-gray-900"},Go={class:"flex items-center justify-between text-sm"},zo={class:"mt-4 pt-4 border-t"},Qo={class:"flex items-center space-x-2 text-sm text-gray-600"},Yo={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50"},Jo={class:"flex items-center justify-center min-h-screen p-4"},Fo={class:"bg-white rounded-lg shadow-xl max-w-md w-full"},Xo={class:"p-6"},Ko={key:0,class:"space-y-4"},Zo={class:"block text-sm font-medium text-gray-700 mb-2"},el={class:"flex items-center space-x-2"},tl=["onUpdate:modelValue"],sl={class:"text-sm font-medium text-gray-900 w-12",id:"preStudyWeightValue"},ol={class:"flex items-center space-x-2"},ll={id:"weightSum",class:"font-medium"},nl={class:"flex justify-end space-x-3 mt-6"},al=U({__name:"index",setup(r){const c=Se(),a=Number(Array.isArray(c.params.pst)?c.params.pst[0]:c.params.pst),u=h(),b=h(),d=h(),t=h(),f=h(),v=h(),g=h(),w=h(0),V=h(),m=h(!1),$=h(new Map),W=(i,o)=>i/o*100,H=(i,o)=>{i.forEach(y=>{!y.hasChildren&&y.components!=null&&y.components.length>0&&["commonGroup","selectGroup"].includes(y.type)&&y.components.forEach(F=>{["QA","MULTIPLECHOICE","CHOICE","TABLE","CIRCUIT","TRACELINE"].includes(F.type)&&F.needCalculate&&(o.labStepQusNum+=1,o.labStepTotalScore+=F.totalScore,o.labStepScore+=F.score)}),y.hasChildren&&H(y.children,o)})},R=i=>{const o={id:null,name:"",weighting:0,labStepQusNum:0,labStepTotalScore:0,labStepScore:0};o.id=i.id,o.name=i.name,o.weighting=i.weighting==null?0:i.weighting,H(i.children,o),$.value.set(i.id,o),console.log($.value)},A=h(!1),M=i=>{A.value=!1,w.value=i,V.value=null,V.value=JSON.parse(JSON.stringify(t.value.studentTaskBook.children[i])),setTimeout(()=>{A.value=!0},100)},D=async i=>{await Ne(i,b.value).then(o=>{o.state==200?(t.value=o.data,t.value&&(localStorage.setItem("teacherRedover-"+a,t.value.id.toString()),$.value.clear(),t.value.studentTaskBook.children.forEach(y=>{R(y)}),M(0))):P.error("获取学生实验内容错误；"+o.message)})},Q=()=>{const i=f.value.findIndex(o=>o.id===v.value.id);if(i==0){P.warning("已经是第一个了");return}v.value=f.value[i-1],D(v.value.id)},j=()=>{const i=f.value.findIndex(o=>o.id===v.value.id);if(i==f.value.length-1){P.warning("已经是最后一个了");return}v.value=f.value[i+1],D(v.value.id)},E=()=>{Ie(t.value.id,t.value.score).then(i=>{i.state==200?(console.log(t.value.hasChecked),t.value.hasChecked=i.data.hasChecked,console.log(t.value.hasChecked)):P.error("保存数据错误："+i.message)})},C=async()=>{await ne(t.value.id).then(i=>{i.state==200?(t.value=i.data,u.value=t.value.projectTask,g.value=t.value.projectStudent,t.value&&($.value.clear(),t.value.studentTaskBook.children.forEach(o=>{R(o)}))):P.error("获取初始数据错误;"+i.message)})},S=h(),J=()=>{S.value={pstId:t.value.id,taskBookId:t.value.taskBookId,totalWeight:0,stepWeightings:[]},$.value.forEach(i=>{let o={blockId:i.id,name:i.name,weighting:i.weighting};S.value.stepWeightings.push(o),S.value.totalWeight+=i.weighting}),m.value=!0},ee=i=>{let o=0;for(let y=0;y<i.length;y++)o+=i[y].weighting;S.value.totalWeight=o},Z=()=>{if(S.value.totalWeight!=100){P.warning("权重总和不等于100，请重设");return}console.log(S.value),qe(S.value).then(i=>{i.state==200?(t.value=i.data,$.value.clear(),t.value.studentTaskBook.children.forEach(o=>{R(o)}),m.value=!1):P.error(i.message)})},be=()=>{setTimeout(async()=>{let i=a;localStorage.getItem("teacherRedover-"+a)!=null&&(i=parseInt(localStorage.getItem("teacherRedover-"+a))),await ne(i).then(o=>{o.state==200?(t.value=o.data,u.value=t.value.projectTask,g.value=t.value.projectStudent,t.value&&(t.value.studentTaskBook.children.forEach(y=>{R(y)}),M(0))):P.error("获取初始数据错误;"+o.message)}),re.on("checkScoreChange",C)},100),pe(u,async i=>{i!=null&&(Re(i).then(o=>{o.state==200?(d.value=o.data,b.value=d.value.num):P.error("获取实验内容错误；"+o.message)}),Ee(i).then(o=>{o.state==200?(f.value=o.data,f.value.forEach(y=>{y.id==g.value&&(v.value=y)})):P.error("获取学生列表错误；"+o.message)}))})};return Y(()=>{be()}),(i,o)=>{const y=z("font-awesome-icon"),F=ue,ve=me;return s(),l("div",As,[e("header",Ls,[e("div",Bs,[e("div",Ps,[e("div",Us,[e("div",Ws,[n(y,{icon:"fa-solid fa-microchip",class:"text-2xl text-indigo-600"}),o[9]||(o[9]=e("h1",{class:"text-xl font-semibold text-gray-900"},"实验评分系统",-1))]),o[10]||(o[10]=e("div",{class:"h-6 w-px bg-gray-300"},null,-1)),o[11]||(o[11]=e("span",{class:"text-sm text-gray-500"},"教师端",-1))]),e("div",Hs,[v.value?(s(),l("div",Ms,[o[13]||(o[13]=e("label",{class:"text-sm font-medium text-gray-700"},"当前学生:",-1)),n(ve,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=k=>v.value=k),"value-key":"id",onChange:o[1]||(o[1]=k=>D(v.value.id))},{default:O(()=>[(s(!0),l(N,null,I(f.value,k=>(s(),q(F,{key:k.id,label:k.stuName+"（"+k.stuId+"）",value:k},{default:O(()=>[e("div",Ds,[e("div",null,_(k.stuName+"("+k.stuId+")"),1),o[12]||(o[12]=e("div",null,null,-1))])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])):p("",!0),e("div",Gs,[e("button",{onClick:o[2]||(o[2]=k=>Q()),class:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg smooth-transition"},[n(y,{icon:"fas fa-chevron-left",class:"mr-1"}),o[14]||(o[14]=G("上一个 ",-1))]),e("button",{onClick:o[3]||(o[3]=k=>j()),class:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg smooth-transition"},[o[15]||(o[15]=G(" 下一个",-1)),n(y,{icon:"fas fa-chevron-right",class:"ml-1"})]),e("button",{onClick:o[4]||(o[4]=k=>E()),class:"px-4 py-1.5 text-sm btn-primary text-white rounded-lg smooth-transition"},[n(y,{icon:"fas fa-save",class:"mr-1"}),o[16]||(o[16]=G("保存评分 ",-1))])])])])])]),e("div",zs,[e("div",Qs,[e("div",Ys,[v.value&&d.value?(s(),l("div",Js,[e("div",Fs,[e("div",Xs,[e("div",Ks,_(v.value.stuName[0]),1),e("div",Zs,[e("div",eo,[e("h2",to,_(v.value.stuName),1),e("h3",so,_(d.value.name),1)]),e("p",oo,"学号: "+_(v.value.stuId),1)])]),e("div",lo,[t.value.status?(s(),l("div",no,[o[17]||(o[17]=e("p",{class:"text-sm text-gray-500"},"提交时间",-1)),e("p",ao,_(x(ae)(t.value.doneTime)),1)])):p("",!0),e("div",ro,[o[20]||(o[20]=e("p",{class:"text-sm text-gray-500"},"实验状态",-1)),t.value.status?(s(),l("p",co,[n(y,{icon:"fas fa-check-circle",class:"mr-2"}),o[19]||(o[19]=G("已完成 ",-1))])):(s(),l("p",io,[n(y,{icon:"fa-solid fa-circle-xmark",class:"mr-2"}),o[18]||(o[18]=G("未完成 ",-1))]))])])])])):p("",!0),t.value?(s(),l("div",uo,[e("div",mo,[(s(!0),l(N,null,I(t.value.studentTaskBook.children,(k,B)=>(s(),l("button",{onClick:te=>M(B),class:L(["flex-1 py-6 px-8 text-center font-medium tab-transition border-b-2",k.id==V.value.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])},[n(y,{icon:k.icon,class:"mr-2"},null,8,["icon"]),G(" "+_(k.name),1)],10,po))),256))])])):p("",!0),V.value!=null?(s(),l("div",xo,[e("div",fo,[e("h3",_o,_(V.value.name),1),e("span",bo," 共 "+_($.value.get(V.value.id).labStepQusNum)+" 题 | 总分 "+_($.value.get(V.value.id).labStepTotalScore)+" 分 ",1)]),A.value?(s(),q(Es,{key:0,"tree-data":V.value.children,class:"ist-theam"},null,8,["tree-data"])):p("",!0)])):p("",!0)]),e("div",vo,[e("div",yo,[e("div",ho,[o[21]||(o[21]=e("h3",{class:"text-lg font-semibold text-gray-900"}," 评分概览 ",-1)),e("button",{onClick:o[5]||(o[5]=k=>J()),class:"text-sm text-gray-500 hover:text-gray-700 smooth-transition"},[n(y,{icon:"fas fa-cog"})])]),t.value?(s(),l("div",go,[(s(!0),l(N,null,I($.value,([k,B],te)=>(s(),l("div",wo,[e("div",ko,[e("div",$o,[e("span",Co,_(B.name),1),B.weighting?(s(),l("span",{key:1,class:L(["text-xs px-2 py-1 rounded-full",B.weighting>50?"bg-blue-100 text-blue-600":"bg-green-100 text-green-600"])},_(B.weighting+"%"),3)):(s(),l("span",So,_(B.weighting+"%"),1))]),e("div",To,[e("span",Vo,_(B.labStepScore),1),e("span",jo,_("/ "+B.labStepTotalScore),1)])]),e("div",Eo,[e("div",{class:"progress-bar h-2 rounded-full",style:Te("width:"+W(B.labStepScore,B.labStepTotalScore)+"%;")},null,4)])]))),256)),e("div",Oo,[e("div",No,[o[23]||(o[23]=e("span",{class:"text-base font-medium text-gray-900"},"加权总分",-1)),e("div",Io,[e("span",qo,_(t.value.score),1),o[22]||(o[22]=e("span",{class:"text-lg text-gray-500"},"/ 100",-1))])]),e("div",Ro,[t.value.score<60?(s(),l("span",Ao,"不合格")):p("",!0),t.value.score>=60&&t.value.score<70?(s(),l("span",Lo,"合格")):p("",!0),t.value.score>=70&&t.value.score<80?(s(),l("span",Bo,"中等")):p("",!0),t.value.score>=80&&t.value.score<90?(s(),l("span",Po,"良好")):p("",!0),t.value.score>=90?(s(),l("span",Uo,"优秀")):p("",!0),o[24]||(o[24]=e("span",{class:"text-xs text-gray-500"},"归一化处理后基于权重计算",-1))])])])):p("",!0)]),t.value?(s(),l("div",Wo,[o[28]||(o[28]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"评分记录",-1)),e("div",Ho,[e("div",Mo,[o[25]||(o[25]=e("span",{class:"text-gray-600"},"AI初版评分",-1)),e("span",Do,_(x(ae)(t.value.aiScoreTime)),1)]),e("div",Go,[o[26]||(o[26]=e("span",{class:"text-gray-600"},"教师是否确认",-1)),e("div",{class:L(t.value.hasChecked?"font-medium text-green-600":"font-medium text-orange-600")},_(t.value.hasChecked?"已确认":"未确认"),3)])]),e("div",zo,[e("div",Qo,[n(y,{icon:"fas fa-info-circle"}),o[27]||(o[27]=e("span",null,"修改后请及时保存评分",-1))])])])):p("",!0)])])]),m.value?(s(),l("div",Yo,[e("div",Jo,[e("div",Fo,[e("div",Xo,[o[31]||(o[31]=e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"权重设置"),e("button",{id:"closeWeightModal",class:"text-gray-400 hover:text-gray-600"},[e("i",{class:"fas fa-times"})])],-1)),S.value&&S.value.stepWeightings.length?(s(),l("div",Ko,[(s(!0),l(N,null,I(S.value.stepWeightings,(k,B)=>(s(),l("div",null,[e("label",Zo,_(k.name)+"权重",1),e("div",el,[Ve(e("input",{type:"range","onUpdate:modelValue":te=>k.weighting=te,min:0,max:100,onChange:o[6]||(o[6]=te=>ee(S.value.stepWeightings)),class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"},null,40,tl),[[je,k.weighting,void 0,{number:!0}]]),e("span",sl,_(k.weighting)+"%",1)])]))),256)),e("div",{class:L(["border rounded p-3",S.value.totalWeight==100?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"])},[e("div",ol,[o[30]||(o[30]=e("i",{class:"fas fa-exclamation-triangle text-yellow-500"},null,-1)),e("span",{class:L(S.value.totalWeight==100?"text-sm text-green-700":"text-sm text-yellow-700")},[o[29]||(o[29]=G(" 权重总和: ",-1)),e("span",ll,_(S.value.totalWeight)+"%",1)],2)])],2)])):p("",!0),e("div",nl,[e("button",{onClick:o[7]||(o[7]=k=>m.value=!1),class:"px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg smooth-transition"}," 取消 "),e("button",{onClick:o[8]||(o[8]=k=>Z()),class:"px-4 py-2 text-sm btn-primary text-white rounded-lg smooth-transition"}," 应用 ")])])])])])):p("",!0),n(Rs)])}}});const _l=le(al,[["__scopeId","data-v-bb4fdbac"]]);export{_l as default};
