import{h as ge,d as K,b as u,m as ue,o as Q,D as Z,a as C,c as B,i as a,g as s,w as d,F as X,j as oe,n as J,L as S,ac as be,a2 as re,a3 as de,ab as ee,u as xe,q as j,t as w,f as ye,ay as he,k as ke,al as Le,ae as Ge,am as _e,a7 as je,_ as we}from"./index-8f9ccc2f.js";/* empty css                             */import{c as Ce}from"./currentProject-a7d14fe5.js";import{P as De}from"./detail-3974838b.js";function Ee(V){return ge({url:"/analysis/project_class_hour",method:"GET",params:{projectId:V}})}const Oe={style:{display:"flex","justify-content":"space-between"}},Ne={style:{display:"flex","flex-direction":"row","align-items":"center"}},Te={style:{"margin-right":"20px"}},Se={style:{"margin-right":"20px"}},Ve=K({__name:"index",props:{projectId:Number},setup(V){const L=V.projectId,p=u(!0),g=u(!0),b=()=>{p.value==!1?(i.series[0].markLine=null,c.setOption(i)):(i.series[0].markLine=h,c.setOption(i))},A=()=>{g.value==!1?(i.series[0].markPoint=null,c.setOption(i)):(i.series[0].markPoint=k,c.setOption(i))},v=u(0),n=u([{studentGrade:null,studentName:"",studentTasks:[{taskNum:null,taskGrade:null}]}]),l=()=>{v.value==0?(y(),c.setOption(i)):(x(),c.setOption(i))},y=()=>{i.xAxis.data=[],i.series[0].data=[];for(let r=0;r<n.value.length;r++)i.xAxis.data.push(n.value[r].studentName),n.value[r].studentGrade?i.series[0].data.push(n.value[r].studentGrade):i.series[0].data.push(0)},x=()=>{i.xAxis.data=[],i.series[0].data=[];for(let r=0;r<n.value.length;r++)i.xAxis.data.push(n.value[r].studentName),n.value[r].studentTasks[v.value-1].taskGrade?i.series[0].data.push(n.value[r].studentTasks[v.value-1].taskGrade):i.series[0].data.push(0)},h={lineStyle:{type:"solid",color:"#3ba272"},label:{formatter:"{b}：{c}"},tooltip:{},symbol:"none",data:[{name:"平均值",type:"average"}]},k={data:[{type:"max",name:"最高分"},{type:"min",name:"最低分"}]},i={xAxis:{show:!1,data:[]},yAxis:{},tooltip:{},series:[{markLine:h,markPoint:k,symbolSize:5,data:[],type:"scatter",color:["#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"]}]};let c=null;function P(){c&&(c.dispose(),c=null)}function q(){c=S(document.getElementById("scatter")),c.setOption(i),window.addEventListener("resize",function(){c.resize()}),window.addEventListener("popstate",function(){P()})}return ue(()=>{De(L).then(r=>{r.state==200&&(n.value=r.data,y())})}),Q(()=>{P(),setTimeout(()=>{q()},1300)}),Z(()=>{P()}),(r,o)=>{const M=be,H=re,$=de,U=ee;return C(),B(X,null,[a("div",null,[a("div",Oe,[o[6]||(o[6]=a("span",null,"学生成绩散点图",-1)),a("div",Ne,[a("div",Te,[s(M,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=m=>p.value=m),label:"平均值",onChange:o[1]||(o[1]=m=>b())},null,8,["modelValue"])]),a("div",Se,[s(M,{modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=m=>g.value=m),label:"极值",onChange:o[3]||(o[3]=m=>A())},null,8,["modelValue"])]),a("div",null,[s($,{modelValue:v.value,"onUpdate:modelValue":o[4]||(o[4]=m=>v.value=m),placeholder:"",size:"small",onChange:o[5]||(o[5]=m=>l())},{default:d(()=>[s(H,{label:"课程成绩",value:0}),(C(!0),B(X,null,oe(n.value[0].studentTasks.length,m=>(C(),J(H,{key:m,label:"实验 "+n.value[0].studentTasks[m-1].taskNum+" 成绩",value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),o[7]||(o[7]=a("div",{id:"scatter",style:{"min-height":"400px"}},null,-1))]),s(U)],64)}}}),Ae=K({__name:"index",props:{gradeList:Array,passGrade:Number},setup(V,{expose:Y}){const L=V,p=u([]),g=u(60),b={xAxis:{type:"category",data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value} %"}},tooltip:{},series:[{data:[],type:"line"}]},A=()=>{if(p.value.length>0){b.xAxis.data=[],b.series[0].data=[];for(let x=0;x<p.value.length;x++){let h=0;for(let k=0;k<p.value[x].gradeList.length;k++)p.value[x].gradeList[k]>=g.value&&(h+=1);b.xAxis.data.push("实验 "+p.value[x].taskNum),b.series[0].data.push(h/p.value[x].gradeList.length*100)}}};let v=null;function n(){v&&(v.dispose(),v=null)}function l(){v=S(document.getElementById("line")),v.setOption(b),window.addEventListener("resize",function(){v.resize()}),window.addEventListener("popstate",function(){n()})}return Y({frashLine:()=>{p.value=L.gradeList,g.value=L.passGrade,A(),v.setOption(b)}}),Q(()=>{p.value=L.gradeList,g.value=L.passGrade,A(),n(),l()}),Z(()=>{n()}),(x,h)=>{const k=ee;return C(),B(X,null,[h[0]||(h[0]=a("div",{style:{display:"flex","flex-direction":"column"}},[a("div",null,[a("span",null,"各实验的学生成绩及格率曲线")]),a("div",{id:"line",style:{"min-height":"400px",width:"100%"}})],-1)),s(k)],64)}}}),Pe={class:"current"},Ie={style:{display:"flex","justify-content":"space-between"}},Re={style:{display:"flex","justify-content":"flex-end"}},ze={style:{"margin-right":"20px"}},Be={style:{"margin-right":"20px"}},Me=K({__name:"index",setup(V){const L=xe().params.projectId,p=u(null),g=u(60),b=u(90),A=()=>{x()},v=()=>{x(),p.value.frashLine()},n=u(0),l=u({numberOfCompleter:null,numberOfParticipant:null,projectGradeList:[],projectTaskStudentsGradeList:[{taskNum:null,gradeList:[]}],personnelDistributions:[{taskNum:null,studentNum:null}],taskAverages:[{taskNum:null,averageGrade:null}],taskMedians:[{taskNum:null,medianGrade:null}],tagsCount:[{item:null,count:null}]}),y=u({classHour:null,totalClassHour:null,completedClassHour:null,completedPercent:null,redaOVerClassHour:null,redaOverPercent:null}),x=()=>{n.value==0?(k(),P(),o()):(i(),q(),M()),O.setOption(ae),N.setOption(le),T.setOption(se)},h=()=>{for(let t=0;t<f.value.length;t++)f.value[t].value=0},k=()=>{h();for(let t=0;t<l.value.projectGradeList.length;t++)l.value.projectGradeList[t]<=100&&l.value.projectGradeList[t]>=90?f.value[5].value+=1:l.value.projectGradeList[t]<90&&l.value.projectGradeList[t]>=80?f.value[4].value+=1:l.value.projectGradeList[t]<80&&l.value.projectGradeList[t]>=70?f.value[3].value+=1:l.value.projectGradeList[t]<70&&l.value.projectGradeList[t]>=60?f.value[2].value+=1:l.value.projectGradeList[t]<60&&l.value.projectGradeList[t]>=50?f.value[1].value+=1:f.value[0].value+=1},i=()=>{h();for(let t=0;t<l.value.projectTaskStudentsGradeList[n.value-1].gradeList.length;t++){let e=l.value.projectTaskStudentsGradeList[n.value-1].gradeList[t];e<=100&&e>90?f.value[5].value+=1:e<=90&&e>80?f.value[4].value+=1:e<=80&&e>70?f.value[3].value+=1:e<=70&&e>60?f.value[2].value+=1:e<=60&&e>50?f.value[1].value+=1:f.value[0].value+=1}},c=()=>{for(let t=0;t<D.value.length;t++)D.value[t].value=0},P=()=>{c();for(let t=0;t<l.value.projectGradeList.length;t++)l.value.projectGradeList[t]>=b.value?D.value[0].value+=1:D.value[1].value+=1},q=()=>{c();for(let t=0;t<l.value.projectTaskStudentsGradeList[n.value-1].gradeList.length;t++)l.value.projectTaskStudentsGradeList[n.value-1].gradeList[t]>=b.value?D.value[0].value+=1:D.value[1].value+=1},r=()=>{for(let t=0;t<E.value.length;t++)E.value[t].value=0},o=()=>{r();for(let t=0;t<l.value.projectGradeList.length;t++)l.value.projectGradeList[t]>=g.value?E.value[0].value+=1:E.value[1].value+=1},M=()=>{r();for(let t=0;t<l.value.projectTaskStudentsGradeList[n.value-1].gradeList.length;t++)l.value.projectTaskStudentsGradeList[n.value-1].gradeList[t]>=g.value?E.value[0].value+=1:E.value[1].value+=1},H=u([]),$=u([]),U=u([]),m=u([]),te=u([]);H.value;const pe={xAxis:{type:"category",data:$.value},yAxis:{type:"value"},series:[{data:U.value,type:"bar",itemStyle:{color:"#d6f1f1",borderRadius:[5,5,0,0]},emphasis:{itemStyle:{color:"#2acecf"}}}],tooltip:{trigger:"axis",formatter:"{b0}: {c0}分"}},ve={xAxis:{type:"category",data:m.value},yAxis:{type:"value"},series:[{data:te.value,type:"bar",itemStyle:{color:"#d6f1f1",borderRadius:[5,5,0,0]},emphasis:{itemStyle:{color:"#2acecf"}}}],tooltip:{trigger:"axis",formatter:"{b0}: {c0}分"}},f=u([{value:0,name:"<50"},{value:0,name:"50-60"},{value:0,name:"60-70"},{value:0,name:"70-80"},{value:0,name:"80-90"},{value:0,name:"90-100"}]),ae={tooltip:{formatter:'{a} <br/> 成绩在区间 "{b}" 的学生有{c}人，占 {d}%'},series:[{name:"成绩区间占比",type:"pie",radius:"60%",data:f.value,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},D=u([{value:0,name:"优秀"},{value:0,name:"一般"}]),le={tooltip:{formatter:"{a} <br/> {b}:{c}人 {d}%"},series:[{name:"成绩优秀占比",type:"pie",color:["#91cc75","#5470c6","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],radius:"60%",data:D.value,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},E=u([{value:0,name:"及格"},{value:0,name:"不及格"}]),se={tooltip:{formatter:"{a} <br/> {b}:{c}人 {d}%"},series:[{name:"成绩及格占比",type:"pie",color:["#3ba272","#ee6666","#73c0de","#91cc75","#5470c6","#fc8452","#9a60b4","#ea7ccc"],radius:"60%",data:E.value,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};let I=null,R=null,O=null,N=null,T=null;function W(){I&&(I.dispose(),I=null),R&&(R.dispose(),R=null),O&&(O.dispose(),O=null),N&&(N.dispose(),N=null),T&&(T.dispose(),T=null)}function ce(){I=S(document.getElementById("chartFive")),R=S(document.getElementById("chartSix")),O=S(document.getElementById("gradeDistribution")),N=S(document.getElementById("excellentRate")),T=S(document.getElementById("passRate")),I.setOption(pe),R.setOption(ve),O.setOption(ae),N.setOption(le),T.setOption(se),window.addEventListener("resize",function(){I.resize(),R.resize(),O.resize(),N.resize(),T.resize()}),window.addEventListener("popstate",function(){W()})}return ue(()=>{Ce(L).then(t=>{if(t.state==200){l.value=t.data;for(let e=0;e<l.value.taskAverages.length;e++)$.value.push("实验"+l.value.taskAverages[e].taskNum),U.value.push(l.value.taskAverages[e].averageGrade);for(let e=0;e<l.value.taskMedians.length;e++)m.value.push("实验"+l.value.taskMedians[e].taskNum),te.value.push(l.value.taskMedians[e].medianGrade);k(),P(),o()}}),Ee(L).then(t=>{t.state==200&&(y.value=t.data)})}),Q(()=>{W(),setTimeout(()=>{ce()},1700)}),Z(()=>{W()}),(t,e)=>{const _=Le,z=Ge,me=_e,F=ee,ne=je,ie=re,fe=de;return C(),B("div",Pe,[a("div",null,[e[16]||(e[16]=a("div",null,[a("span",null,"课程当前状态")],-1)),s(me,{column:2,border:!0,size:"large",style:{"margin-top":"20px"}},{default:d(()=>[s(_,{label:"学生人数","label-align":"right",align:"center","label-class-name":"my-label","class-name":"my-content"},{default:d(()=>[j(w(l.value.numberOfParticipant),1)]),_:1}),s(_,{label:"已完成学生人数","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[s(z,null,{default:d(()=>[j(w(l.value.numberOfCompleter),1)]),_:1})]),_:1}),s(_,{label:"课程课时","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[j(w(y.value.classHour),1)]),_:1}),s(_,{label:"总课时","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[j(w(y.value.totalClassHour),1)]),_:1}),s(_,{label:"已完成课时(学生)","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[e[4]||(e[4]=a("br",null,null,-1)),s(z,null,{default:d(()=>[j(w(y.value.completedClassHour),1)]),_:1}),e[5]||(e[5]=a("br",null,null,-1)),e[6]||(e[6]=a("span",{class:"tips"},"已完成课时(学生) = 所有学生已完成的课时之和",-1))]),_:1}),s(_,{label:"课程进度(学生)","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[e[7]||(e[7]=a("br",null,null,-1)),s(z,null,{default:d(()=>[j(w(y.value.completedPercent)+"%",1)]),_:1}),e[8]||(e[8]=a("br",null,null,-1)),e[9]||(e[9]=a("span",{class:"tips"},"课程进度(学生) = (所有学生已完成的课时之和 / 总课时) * 100%",-1))]),_:1,__:[7,8,9]}),s(_,{label:"已完成课时(教师)","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[e[10]||(e[10]=a("br",null,null,-1)),s(z,null,{default:d(()=>[j(w(y.value.redaOVerClassHour),1)]),_:1}),e[11]||(e[11]=a("br",null,null,-1)),e[12]||(e[12]=a("span",{class:"tips"},"已完成课时(教师) = 所有已完成批阅打分的课时之和",-1))]),_:1}),s(_,{label:"课程进度(教师)","label-align":"right",align:"center","label-class-name":"my-label"},{default:d(()=>[e[13]||(e[13]=a("br",null,null,-1)),s(z,null,{default:d(()=>[j(w(y.value.redaOverPercent)+"%",1)]),_:1}),e[14]||(e[14]=a("br",null,null,-1)),e[15]||(e[15]=a("span",{class:"tips"},"课程进度(教师) = (所有已批阅打分的课时之和 / 总课时) * 100%",-1))]),_:1,__:[13,14,15]})]),_:1})]),s(F,{style:{"margin-top":"30px"}}),s(Ve,{projectId:ye(L)},null,8,["projectId"]),a("div",null,[a("div",Ie,[e[19]||(e[19]=a("span",null,"学生成绩分析",-1)),a("div",Re,[a("div",ze,[e[17]||(e[17]=a("span",null,"优秀成绩：",-1)),s(ne,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=G=>b.value=G),min:0,max:100,size:"small","controls-position":"right",onChange:A},null,8,["modelValue"])]),a("div",Be,[e[18]||(e[18]=a("span",null,"及格成绩：",-1)),s(ne,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=G=>g.value=G),min:0,max:100,size:"small","controls-position":"right",onChange:v},null,8,["modelValue"])]),a("div",null,[s(fe,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=G=>n.value=G),placeholder:"",size:"small",onChange:e[3]||(e[3]=G=>x())},{default:d(()=>[s(ie,{label:"课程成绩",value:0}),(C(!0),B(X,null,oe(l.value.taskMedians.length,G=>(C(),J(ie,{key:l.value.taskMedians[G-1].taskNum,label:"实验"+l.value.taskMedians[G-1].taskNum+" 成绩",value:G},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),e[20]||(e[20]=he('<div style="display:flex;flex-direction:row;height:100%;width:100%;margin-top:20px;" data-v-3ec1ff7d><div style="flex:1;text-align:center;display:flex;flex-direction:column;" data-v-3ec1ff7d><span data-v-3ec1ff7d>成绩分布占比饼图</span><div id="gradeDistribution" style="min-height:400px;flex:1;" data-v-3ec1ff7d></div></div><div style="flex:1;text-align:center;display:flex;flex-direction:column;" data-v-3ec1ff7d><span data-v-3ec1ff7d>优秀率占比饼图</span><div id="excellentRate" style="min-height:400px;flex:1;" data-v-3ec1ff7d></div></div><div style="flex:1;text-align:center;display:flex;flex-direction:column;" data-v-3ec1ff7d><span data-v-3ec1ff7d>及格率占比饼图</span><div id="passRate" style="min-height:400px;flex:1;" data-v-3ec1ff7d></div></div></div>',1))]),s(F),l.value.projectTaskStudentsGradeList[0].taskNum!=null?(C(),J(Ae,{key:0,ref_key:"line",ref:p,gradeList:l.value.projectTaskStudentsGradeList,passGrade:g.value},null,8,["gradeList","passGrade"])):ke("",!0),e[21]||(e[21]=a("div",null,[a("div",null,[a("span",null,"课程各实验成绩平均分数对比图")]),a("div",{id:"chartFive",style:{"min-height":"400px"}})],-1)),s(F),e[22]||(e[22]=a("div",null,[a("div",null,[a("span",null,"课程各实验成绩中位数对比图")]),a("div",{id:"chartSix",style:{"min-height":"400px"}})],-1)),s(F)])}}});const Xe=we(Me,[["__scopeId","data-v-3ec1ff7d"]]);export{Xe as default};
