import{h as R,d as U,u as z,b as g,m as G,a as s,c as V,g as l,w as t,i as v,F as $,j as M,n as p,q as a,t as i,k as m,s as b,y as q,a2 as L,a3 as A,x as H,N as J,ap as K,O as Q,a8 as W,_ as X}from"./index-8f9ccc2f.js";function Y(k){return R({url:"/task/project_tasks",method:"GET",params:{projectId:k}})}function Z(k){return R({url:"/dup/by_task",method:"GET",params:{taskId:k}})}function ee(k){return R({url:"/dup/gen",method:"POST",params:{taskId:k}})}const te={style:{"margin-top":"20px"}},le=U({__name:"index",setup(k){const h=z().params.projectId,y=g(0),I=g([]),d=g([]),c=g([]),F=g(""),_=(r,n)=>{F.value="/pdf/web/viewer.html?file=/local-resource/file/"+r+"?pstresourceid="+n,window.open(F.value)},N=r=>{if(r>=80)return"danger";if(r>=50)return"warning"},x=()=>{c.value=[];let r={pstId:d.value[0].pstId,studentId:d.value[0].studentId,studentName:d.value[0].studentName,duplicates:[]};c.value.push(Object.assign(r));for(let n=0;n<d.value.length;n++){if(d.value[n].pstId!=c.value[c.value.length-1].pstId){let u={pstId:d.value[n].pstId,studentId:d.value[n].studentId,studentName:d.value[n].studentName,duplicates:[]};c.value.push(Object.assign(u))}c.value[c.value.length-1].duplicates.push(d.value[n])}console.log(c.value)},S=()=>{ee(y.value).then(r=>{r.state==200?(d.value=r.data,x(),b.success("已生成")):b.warning(r.message)})},E=r=>{c.value=[],Z(r).then(n=>{n.state==200?(d.value=n.data,x()):b.warning(n.message)})},O=g(!1),T=g("");return G(()=>{console.log(h),Y(h).then(r=>{r.state==200&&(I.value=r.data,I.value.length>0&&(y.value=I.value[0].id,E(y.value)))})}),(r,n)=>{const u=q,j=L,P=A,o=H,f=J,C=K,B=Q,D=W;return s(),V($,null,[l(u,null,{default:t(()=>n[3]||(n[3]=[v("div",{style:{"font-size":"18px","font-weight":"bold"}}," 任务/实验下学生提交报告的重复率检测报告 ",-1)])),_:1,__:[3]}),l(u,{style:{"justify-content":"space-between","margin-top":"20px"}},{default:t(()=>[l(P,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=e=>y.value=e),class:"m-2",placeholder:"Select",size:"small",onChange:n[1]||(n[1]=e=>E(y.value))},{default:t(()=>[(s(!0),V($,null,M(I.value,e=>(s(),p(j,{key:e.num,label:e.taskName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(o,{type:"primary",link:"",onClick:S},{default:t(()=>n[4]||(n[4]=[a(" 重新生成 ",-1)])),_:1,__:[4]})]),_:1}),v("div",te,[l(B,{data:c.value,style:{width:"100%"}},{default:t(()=>[l(f,{prop:"studentName",label:"学生",width:"100",align:"center"}),l(f,{label:"重复率",align:"center"},{default:t(()=>[l(f,{align:"center"},{default:t(e=>[e.row.duplicates[0]?(s(),p(C,{key:0,placement:"top-start",title:"重复信息",width:300,trigger:"hover"},{reference:t(()=>[e.row.duplicates[0]?(s(),p(o,{key:0,link:"",type:N(e.row.duplicates[0].repetitiveRate)},{default:t(()=>[a(i(e.row.duplicates[0].repetitiveRate)+"% ",1)]),_:2},1032,["type"])):m("",!0)]),default:t(()=>[v("div",null,[l(u,null,{default:t(()=>[a(i(e.row.duplicates[0].studentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[0].fileName,e.row.pstId)},{default:t(()=>[a(i(e.row.duplicates[0].originFilename),1)]),_:2},1032,["onClick"])]),_:2},1024),l(u,null,{default:t(()=>[a(i("有"+e.row.duplicates[0].repetitiveRate+"% 的内容与"),1)]),_:2},1024),l(u,null,{default:t(()=>[a(i(e.row.duplicates[0].contrastStudentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[0].contrastFileName,e.row.duplicates[0].contrastPstId)},{default:t(()=>[a(i(e.row.duplicates[0].contrastOriginFilename),1)]),_:2},1032,["onClick"]),n[5]||(n[5]=a(" 相同。 ",-1))]),_:2,__:[5]},1024),l(u)])]),_:2},1024)):m("",!0)]),_:1}),l(f,{align:"center"},{default:t(e=>[e.row.duplicates[1]?(s(),p(C,{key:0,placement:"top-start",title:"重复信息",width:300,trigger:"hover"},{reference:t(()=>[e.row.duplicates[1]?(s(),p(o,{key:0,link:"",type:N(e.row.duplicates[1].repetitiveRate)},{default:t(()=>[a(i(e.row.duplicates[1].repetitiveRate)+"% ",1)]),_:2},1032,["type"])):m("",!0)]),default:t(()=>[v("div",null,[l(u,null,{default:t(()=>[a(i(e.row.duplicates[1].studentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[1].fileName,e.row.pstId)},{default:t(()=>[a(i(e.row.duplicates[1].originFilename),1)]),_:2},1032,["onClick"])]),_:2},1024),l(u,null,{default:t(()=>[a(i("有"+e.row.duplicates[1].repetitiveRate+"% 的内容与"),1)]),_:2},1024),l(u,null,{default:t(()=>[a(i(e.row.duplicates[1].contrastStudentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[1].contrastFileName,e.row.duplicates[1].contrastPstId)},{default:t(()=>[a(i(e.row.duplicates[1].contrastOriginFilename),1)]),_:2},1032,["onClick"]),n[6]||(n[6]=a(" 相同。 ",-1))]),_:2,__:[6]},1024),l(u)])]),_:2},1024)):m("",!0)]),_:1}),l(f,{align:"center"},{default:t(e=>[e.row.duplicates[2]?(s(),p(C,{key:0,placement:"top-start",title:"重复信息",width:300,trigger:"hover"},{reference:t(()=>[e.row.duplicates[2]?(s(),p(o,{key:0,link:"",type:N(e.row.duplicates[2].repetitiveRate)},{default:t(()=>[a(i(e.row.duplicates[2].repetitiveRate)+"% ",1)]),_:2},1032,["type"])):m("",!0)]),default:t(()=>[v("div",null,[l(u,null,{default:t(()=>[a(i(e.row.duplicates[2].studentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[2].fileName,e.row.pstId)},{default:t(()=>[a(i(e.row.duplicates[2].originFilename),1)]),_:2},1032,["onClick"])]),_:2},1024),l(u,null,{default:t(()=>[a(i("有"+e.row.duplicates[2].repetitiveRate+"% 的内容与"),1)]),_:2},1024),l(u,null,{default:t(()=>[a(i(e.row.duplicates[2].contrastStudentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[2].contrastFileName,e.row.duplicates[2].contrastPstId)},{default:t(()=>[a(i(e.row.duplicates[2].contrastOriginFilename),1)]),_:2},1032,["onClick"]),n[7]||(n[7]=a(" 相同。 ",-1))]),_:2,__:[7]},1024),l(u)])]),_:2},1024)):m("",!0)]),_:1}),l(f,{align:"center"},{default:t(e=>[e.row.duplicates[3]?(s(),p(C,{key:0,placement:"top-start",title:"重复信息",width:300,trigger:"hover"},{reference:t(()=>[e.row.duplicates[3]?(s(),p(o,{key:0,link:"",type:N(e.row.duplicates[3].repetitiveRate)},{default:t(()=>[a(i(e.row.duplicates[3].repetitiveRate)+"% ",1)]),_:2},1032,["type"])):m("",!0)]),default:t(()=>[v("div",null,[l(u,null,{default:t(()=>[a(i(e.row.duplicates[3].studentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[3].fileName,e.row.pstId)},{default:t(()=>[a(i(e.row.duplicates[3].originFilename),1)]),_:2},1032,["onClick"])]),_:2},1024),l(u,null,{default:t(()=>[a(i("有"+e.row.duplicates[3].repetitiveRate+"% 的内容与"),1)]),_:2},1024),l(u,null,{default:t(()=>[a(i(e.row.duplicates[3].contrastStudentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[3].contrastFileName,e.row.duplicates[3].contrastPstId)},{default:t(()=>[a(i(e.row.duplicates[3].contrastOriginFilename),1)]),_:2},1032,["onClick"]),n[8]||(n[8]=a(" 相同。 ",-1))]),_:2,__:[8]},1024),l(u)])]),_:2},1024)):m("",!0)]),_:1}),l(f,{align:"center"},{default:t(e=>[e.row.duplicates[4]?(s(),p(C,{key:0,placement:"top-start",title:"重复信息",width:300,trigger:"hover"},{reference:t(()=>[e.row.duplicates[4]?(s(),p(o,{key:0,link:"",type:N(e.row.duplicates[4].repetitiveRate)},{default:t(()=>[a(i(e.row.duplicates[4].repetitiveRate)+"% ",1)]),_:2},1032,["type"])):m("",!0)]),default:t(()=>[v("div",null,[l(u,null,{default:t(()=>[a(i(e.row.duplicates[4].studentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[4].fileName,e.row.pstId)},{default:t(()=>[a(i(e.row.duplicates[4].originFilename),1)]),_:2},1032,["onClick"])]),_:2},1024),l(u,null,{default:t(()=>[a(i("有"+e.row.duplicates[4].repetitiveRate+"% 的内容与"),1)]),_:2},1024),l(u,null,{default:t(()=>[a(i(e.row.duplicates[4].contrastStudentName+"的文件：")+" ",1),l(o,{link:"",type:"primary",onClick:w=>_(e.row.duplicates[4].contrastFileName,e.row.duplicates[4].contrastPstId)},{default:t(()=>[a(i(e.row.duplicates[4].contrastOriginFilename),1)]),_:2},1032,["onClick"]),n[9]||(n[9]=a(" 相同。 ",-1))]),_:2,__:[9]},1024),l(u)])]),_:2},1024)):m("",!0)]),_:1})]),_:1})]),_:1},8,["data"])]),l(D,{modelValue:O.value,"onUpdate:modelValue":n[2]||(n[2]=e=>O.value=e),title:"重复内容"},{default:t(()=>[v("div",null,i(T.value),1)]),_:1},8,["modelValue"])],64)}}});const ie=X(le,[["__scopeId","data-v-eb04e2ee"]]);export{ie as default};
