import{h,d as ne,b as C,S as ae,m as oe,a as s,c as y,g as l,w as t,i as r,t as c,n as S,f as g,aA as ie,k as U,as as P,V as q,q as b,aB as z,U as J,aC as de,F as ue,j as re,s as v,N as se,x as me,au as ve,a9 as pe,O as fe,$ as _e,a0 as ce,a2 as be,a3 as ye,ad as ge,a8 as ke,Q as we}from"./index-8f9ccc2f.js";function Ce(){return h({url:"/device/all",method:"GET"})}function he(){return h({url:"/device/remote_type",method:"GET"})}function xe(w,m){return h({url:"/device/add_remote_device/"+m,method:"POST",data:w})}function L(w,m){return h({url:"/device/change_remote_control",method:"POST",params:{id:w,targetState:m}})}function De(w){return h({url:"/device/del_remote_device",method:"POST",params:{deviceId:w}})}function $e(w){return h({url:"/device/refresh_status",method:"POST",params:{id:w}})}const Ve={style:{"text-align":"center"}},Ie={style:{"text-align":"center"}},Se={style:{"text-align":"center"}},Ue={style:{"text-align":"center"}},ze={style:{"text-align":"center"}},Ee={key:0,style:{padding:"0 5rem"}},Ne={key:0},Re={key:1},Te={key:0},Oe={key:1},Be={key:0},Ae={key:1},Fe={class:"dialog-footer"},Pe={key:0},qe={key:1},Je={class:"dialog-footer"},Qe=ne({__name:"index",setup(w){const m=C(),Q=()=>{Ce().then(o=>{o.state==200?m.value=o.data:v.error(o.message)})},$=C([]),G=()=>{he().then(o=>{o.state==200?$.value=o.data:v.error(o.message)})},W=o=>{console.log(o),x.value=!0,u.value.pId=o},x=C(!1),p=C("100px"),E=C(),u=C({snId:"",name:"",pId:null,type:null,ip:"",port:null,liveUrl:null}),M=ae({name:[{required:!0,message:"请输入名称",trigger:"blur"}],snId:[{required:!0,message:"请输入SN号",trigger:"blur"}],ip:[{required:!0,message:"请输入ip地址",trigger:"blur"},{validator:function(o,e,d){!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e)&&e!==""?d(new Error("请输入正确的IP地址")):d()},trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"}]}),j=o=>{console.log($.value[o]),u.value.port=$.value[o].port},H=()=>{u.value.snId="",u.value.name="",u.value.pId=null,u.value.type=null,u.value.ip="",u.value.port=null,u.value.liveUrl=""},K=async o=>{o&&await o.validate((e,d)=>{e?xe(JSON.parse(JSON.stringify(u.value)),u.value.pId).then(a=>{a.state==200?(m.value=a.data,x.value=!1,v.success("添加成功")):v.error(a.message)}):v.warning("表单提交错误")})},N=(o,e,d)=>{m.value[o].remoteDevices[e].remoteControl==1&&L(d,0).then(a=>{a.state==200?(m.value[o].remoteDevices[e]=a.data,v.success("操作成功")):v.error(a.message)})},R=(o,e,d)=>{m.value[o].remoteDevices[e].remoteControl==0&&L(d,1).then(a=>{a.state==200?(m.value[o].remoteDevices[e]=a.data,v.success("操作成功")):v.error(a.message)})},X=o=>{De(o).then(e=>{e.state==200?(m.value=e.data,v.success("操作成功")):v.error(e.message)})},I=(o,e,d)=>{$e(d).then(a=>{a.state==200?(m.value[o].remoteDevices[e]=a.data,v.success("操作成功")):v.error(a.message)})},f=C(),V=C(!1),Y=o=>{f.value=JSON.parse(JSON.stringify(o)),V.value=!0},Z=()=>{V.value=!1};return oe(()=>{Q(),G()}),(o,e)=>{const d=se,a=me,T=ve,O=pe,B=fe,D=_e,_=ce,ee=be,le=ye,A=ge,F=ke,te=we;return s(),y("div",null,[l(B,{data:m.value,"row-key":"id",style:{"min-height":"65vh"},stripe:"","header-cell-style":{fontWeight:"bold",textAlign:"center"},"row-style":{flexGrow:1}},{default:t(()=>[l(d,{label:"SNID"},{default:t(n=>[r("div",Ve,[r("span",null,c(n.row.snId),1)])]),_:1}),l(d,{label:"名称"},{default:t(n=>[r("div",Ie,[r("span",null,c(n.row.name),1)])]),_:1}),l(d,{label:"version"},{default:t(n=>[r("div",Se,[r("span",null,c(n.row.version),1)])]),_:1}),l(d,{label:"状态"},{default:t(n=>[r("div",Ue,c(n.row.status),1)]),_:1}),l(d,{label:"操作"},{default:t(n=>[r("div",ze,[n.row.type==0?(s(),S(a,{key:0,type:"primary",link:"",size:"small",icon:g(ie),onClick:i=>W(n.row.id)},null,8,["icon","onClick"])):U("",!0),l(T,{title:"确定删除该设备及其关联设备吗?","confirm-button-text":"确定","cancel-button-text":"取消",onConfirm:e[0]||(e[0]=()=>{})},{reference:t(()=>[l(a,{type:"danger",link:"",size:"small",icon:g(P)},null,8,["icon"])]),_:1})])]),_:1}),l(d,{type:"expand"},{default:t(n=>[n.row.remoteDevices?(s(),y("div",Ee,[l(B,{data:n.row.remoteDevices,border:"","header-cell-style":{fontWeight:"bold"}},{default:t(()=>[l(d,{prop:"snId",label:"SNID"}),l(d,{prop:"name",label:"名称"}),l(d,{prop:"typeName",label:"远程方式"}),l(d,{prop:"ip",label:"IP"}),l(d,{prop:"port",label:"端口"}),l(d,null,{header:t(()=>[e[13]||(e[13]=r("span",null,"开启远程操作",-1)),l(O,{content:"操作onlineBox开启/关闭一个远程服务;由高亮表示当前状态",placement:"bottom",effect:"light"},{default:t(()=>[l(a,{link:"",icon:g(q),size:"small"},null,8,["icon"])]),_:1})]),default:t(i=>[i.row.remoteControl==0?(s(),y("div",Ne,[l(a,{type:"primary",link:"",size:"small",onClick:k=>N(n.$index,i.$index,i.row.id)},{default:t(()=>e[14]||(e[14]=[b("关闭",-1)])),_:2,__:[14]},1032,["onClick"]),l(a,{link:"",size:"small",onClick:k=>R(n.$index,i.$index,i.row.id)},{default:t(()=>e[15]||(e[15]=[b("开启",-1)])),_:2,__:[15]},1032,["onClick"]),l(a,{type:"primary",link:"",icon:g(z),onClick:k=>I(n.$index,i.$index,i.row.id)},null,8,["icon","onClick"])])):(s(),y("div",Re,[l(a,{link:"",size:"small",onClick:k=>N(n.$index,i.$index,i.row.id)},{default:t(()=>e[16]||(e[16]=[b("关闭",-1)])),_:2,__:[16]},1032,["onClick"]),l(a,{type:"primary",link:"",size:"small",onClick:k=>R(n.$index,i.$index,i.row.id)},{default:t(()=>e[17]||(e[17]=[b("开启",-1)])),_:2,__:[17]},1032,["onClick"]),l(a,{type:"primary",link:"",icon:g(z),onClick:k=>I(n.$index,i.$index,i.row.id)},null,8,["icon","onClick"])]))]),_:2},1024),l(d,null,{header:t(()=>[e[18]||(e[18]=r("span",null,"设备状态",-1)),l(O,{content:"该远程服务中设备连通状态;由高亮表示当前状态",placement:"bottom",effect:"light"},{default:t(()=>[l(a,{link:"",icon:g(q),size:"small"},null,8,["icon"])]),_:1})]),default:t(i=>[r("div",null,[i.row.deviceState==1?(s(),y("span",Te,"在线")):(s(),y("span",Oe,"离线")),l(a,{type:"primary",link:"",icon:g(z),onClick:k=>I(n.$index,i.$index,i.row.id)},null,8,["icon","onClick"])])]),_:2},1024),l(d,{label:"允许预约"},{default:t(i=>[i.row.allowAppointment==0?(s(),y("div",Be,[l(a,{type:"primary",link:"",size:"small"},{default:t(()=>e[19]||(e[19]=[b("关闭",-1)])),_:1,__:[19]}),l(a,{link:"",size:"small"},{default:t(()=>e[20]||(e[20]=[b("开启",-1)])),_:1,__:[20]})])):(s(),y("div",Ae,[l(a,{link:"",size:"small"},{default:t(()=>e[21]||(e[21]=[b("关闭",-1)])),_:1,__:[21]}),l(a,{type:"primary",link:"",size:"small"},{default:t(()=>e[22]||(e[22]=[b("开启",-1)])),_:1,__:[22]})]))]),_:1}),l(d,{label:"设备单次预约时长/min"},{default:t(i=>[r("div",null,[r("span",null,c(i.row.singleDuration),1),l(a,{type:"primary",link:"",size:"small",icon:g(J)},null,8,["icon"])])]),_:1}),l(d,{label:"操作"},{default:t(i=>[r("div",null,[l(a,{type:"primary",link:"",size:"small",icon:g(de),onClick:k=>Y(i.row)},null,8,["icon","onClick"]),l(a,{type:"primary",link:"",size:"small",icon:g(J)},null,8,["icon"]),l(T,{title:"确定删除该设备吗?","confirm-button-text":"确定","cancel-button-text":"取消",onConfirm:k=>X(i.row.id)},{reference:t(()=>[l(a,{type:"danger",link:"",size:"small",icon:g(P)},null,8,["icon"])]),_:2},1032,["onConfirm"])])]),_:1})]),_:2},1032,["data"])])):U("",!0)]),_:1})]),_:1},8,["data"]),l(F,{modelValue:x.value,"onUpdate:modelValue":e[9]||(e[9]=n=>x.value=n),title:"添加远程设备",width:"550",onClose:e[10]||(e[10]=n=>H())},{footer:t(()=>[r("div",Fe,[l(a,{onClick:e[7]||(e[7]=n=>x.value=!1)},{default:t(()=>e[23]||(e[23]=[b("取消",-1)])),_:1,__:[23]}),l(a,{type:"primary",onClick:e[8]||(e[8]=n=>K(E.value))},{default:t(()=>e[24]||(e[24]=[b(" 添加 ",-1)])),_:1,__:[24]})])]),default:t(()=>[l(A,{model:u.value,ref_key:"ruleFormRef",ref:E,rules:M},{default:t(()=>[l(_,{label:"SNID：","label-width":p.value,prop:"snId"},{default:t(()=>[l(D,{modelValue:u.value.snId,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value.snId=n),type:"text",oninput:"value=value.replace(/[^\\d.]/g,'')",maxlength:"11",minlength:"11"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(_,{label:"名称：","label-width":p.value,prop:"name"},{default:t(()=>[l(D,{modelValue:u.value.name,"onUpdate:modelValue":e[2]||(e[2]=n=>u.value.name=n)},null,8,["modelValue"])]),_:1},8,["label-width"]),l(_,{label:"远程方式：","label-width":p.value},{default:t(()=>[l(le,{modelValue:u.value.type,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value.type=n),placeholder:"选择远程方式",style:{width:"240px"}},{default:t(()=>[(s(!0),y(ue,null,re($.value,(n,i)=>(s(),S(ee,{key:n.id,label:n.name,value:n.id,onClick:k=>j(i)},null,8,["label","value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(_,{label:"ip：","label-width":p.value,prop:"ip"},{default:t(()=>[l(D,{modelValue:u.value.ip,"onUpdate:modelValue":e[4]||(e[4]=n=>u.value.ip=n)},null,8,["modelValue"])]),_:1},8,["label-width"]),l(_,{label:"端口","label-width":p.value,prop:"port"},{default:t(()=>[l(D,{modelValue:u.value.port,"onUpdate:modelValue":e[5]||(e[5]=n=>u.value.port=n),type:"text",oninput:"value=value.replace(/[^\\d.]/g,'')",maxlength:"5",minlength:"2"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(_,{label:"直播地址","label-width":p.value},{default:t(()=>[l(D,{modelValue:u.value.liveUrl,"onUpdate:modelValue":e[6]||(e[6]=n=>u.value.liveUrl=n)},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(F,{modelValue:V.value,"onUpdate:modelValue":e[12]||(e[12]=n=>V.value=n),title:"设备详情",width:"600"},{footer:t(()=>[r("div",Je,[l(a,{type:"primary",onClick:e[11]||(e[11]=n=>Z())},{default:t(()=>e[25]||(e[25]=[b(" 确定 ",-1)])),_:1,__:[25]})])]),default:t(()=>[l(A,{model:f.value},{default:t(()=>[l(_,{label:"名称：","label-width":p.value},{default:t(()=>[r("span",null,c(f.value.name),1)]),_:1},8,["label-width"]),l(_,{label:"SNID：","label-width":p.value},{default:t(()=>[r("span",null,c(f.value.snId),1)]),_:1},8,["label-width"]),l(_,{label:"远程方式：","label-width":p.value},{default:t(()=>[r("span",null,c(f.value.typeName),1)]),_:1},8,["label-width"]),l(_,{label:"ip：","label-width":p.value},{default:t(()=>[r("span",null,c(f.value.ip),1)]),_:1},8,["label-width"]),l(_,{label:"端口：","label-width":p.value},{default:t(()=>[r("span",null,c(f.value.port),1)]),_:1},8,["label-width"]),l(_,{label:"操作地址：","label-width":p.value},{default:t(()=>[f.value.type==2?(s(),y("span",Pe,[f.value.remoteUrl!=""?(s(),S(te,{key:0,href:"/vnc/vnc.html"+f.value.remoteUrl,target:"_blank"},{default:t(()=>[b(c("/vnc/vnc.html"+f.value.remoteUrl),1)]),_:1},8,["href"])):U("",!0)])):(s(),y("span",qe,c(f.value.remoteUrl),1))]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Qe as default};
