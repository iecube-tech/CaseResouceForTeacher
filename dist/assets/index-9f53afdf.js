import{d as te,b as r,S as ce,m as le,a as n,c as f,g as e,w as t,q as x,F as j,j as B,n as U,t as G,s as q,G as ke,$ as _e,a0 as me,a5 as Ve,a6 as Te,ad as pe,x as oe,y as se,_ as re,e as xe,i as V,P as Le,af as be,k as A,f as H,as as fe,aP as ee,N as Ce,au as we,O as Se,ae as ye,E as De,a7 as Ie,a8 as Oe,v as qe,U as Pe,ab as je,aM as Be,A as Je,aj as Ge,u as Ae,r as Qe,an as Me,ao as He}from"./index-8f9ccc2f.js";/* empty css                */import{U as Ke,c as Re,u as We,a as Xe,T as Ye,E as Ze,b as et}from"./updateContent-99cb4197.js";import{a as Ne,A as tt,D as lt}from"./deleteCourseDesign-d8ec59d6.js";import{C as at}from"./courseDesign-baa6b6b5.js";import{c as nt}from"./getTaskTemplates-4d34e142.js";import{a as he,u as Ue,d as ot,G as st,c as ut,b as it}from"./updateTaskTemplate-f6a23dc4.js";const rt={id:"pane-first",class:"pane",key:"0"},dt=te({__name:"one",props:{courseId:Number},emits:["nextStep","created"],setup(M,{emit:J}){const p=M,g=r(0),L=r(),k=r({id:null,name:"",introduction:"",introduce:"",target:"",cover:"",completion:null,guidance:"",third:1,deviceId:null}),D=r([]),R=ce({name:[{required:!0,message:"请输入课程名称",trigger:"blur"}],introduction:[{required:!0,message:"请输入课程简介",trigger:"blur"}],introduce:[{required:!0,message:"请输入课程详细介绍",trigger:"blur"}],target:[{required:!0,message:"请输入课程目标",trigger:"blur"}]}),$=s=>{s&&s.validate((y,N)=>{y?(k.value.id=g.value,Ke(Object.assign({},k.value)).then(w=>{w.state==200?(k.value=w.data,g.value=w.data.id,O(g.value),v(k.value.completion)):q.error(w.message)})):q.error})},h=J,v=s=>{h("nextStep",s)},O=s=>{h("created",s)},_=s=>{ke(s).then(y=>{y.state==200?k.value=y.data:q.error(y.message)})},l=()=>{Ne().then(s=>{s.state==200?D.value=s.data:q.error("获取iecube设备列表异常")})};return le(()=>{g.value=p.courseId,_(g.value),l()}),(s,y)=>{const N=_e,w=me,c=Ve,z=Te,P=pe,Q=oe,o=se;return n(),f("div",rt,[e(P,{ref_key:"contentFormRef",ref:L,model:k.value,rules:R,"label-width":"120px",class:"contentForm"},{default:t(()=>[e(w,{label:"课程名称",prop:"name"},{default:t(()=>[e(N,{modelValue:k.value.name,"onUpdate:modelValue":y[0]||(y[0]=a=>k.value.name=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"课程简介",prop:"introduction"},{default:t(()=>[e(N,{type:"textarea",autosize:{minRows:2,maxRows:4},modelValue:k.value.introduction,"onUpdate:modelValue":y[1]||(y[1]=a=>k.value.introduction=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"课程介绍",prop:"introduce"},{default:t(()=>[e(N,{type:"textarea",autosize:{minRows:2,maxRows:4},modelValue:k.value.introduce,"onUpdate:modelValue":y[2]||(y[2]=a=>k.value.introduce=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"课程目标",prop:"target"},{default:t(()=>[e(N,{type:"textarea",autosize:{minRows:2,maxRows:4},modelValue:k.value.target,"onUpdate:modelValue":y[3]||(y[3]=a=>k.value.target=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"实验设备",prop:"deviceId"},{default:t(()=>[e(z,{modelValue:k.value.deviceId,"onUpdate:modelValue":y[4]||(y[4]=a=>k.value.deviceId=a)},{default:t(()=>[e(c,{label:0},{default:t(()=>y[6]||(y[6]=[x("无设备",-1)])),_:1,__:[6]}),(n(!0),f(j,null,B(D.value,a=>(n(),U(c,{label:a.id},{default:t(()=>[x(G(a.name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),e(o,{class:"bottom-row"},{default:t(()=>[e(Q,{type:"primary",onClick:y[5]||(y[5]=a=>$(L.value))},{default:t(()=>y[7]||(y[7]=[x("下一步",-1)])),_:1,__:[7]})]),_:1})])}}});const mt=re(dt,[["__scopeId","data-v-8ca4dfe4"]]),pt={id:"pane-second",class:"pane",key:"1"},vt={class:"cover-upload"},ct=["src"],_t=te({__name:"two",props:{courseId:Number},emits:["nextStep","lastStep"],setup(M,{emit:J}){const p=M,g=r(0),L=r({"x-access-token":localStorage.getItem("x-access-token"),"x-access-type":localStorage.getItem("x-access-type")}),k=r({id:null,name:"",introduction:"",introduce:"",target:"",cover:"",completion:null,guidance:"",third:0}),D=J,R=l=>{D("nextStep",l)},$=()=>{D("lastStep")},h=(l,s)=>{l.state==200&&(k.value.cover=l.data.filename)},v=l=>{if(g.value==0&&q.error("请先完成上一步"),!(l.type=="image/jpeg"||l.type=="image/png"||l.type=="image/gif"))q.error("支持 JPG，PNG， GIF！");else if(l.size/1024/1024>5)return q.error("图片不要大于 2MB!"),!1;return!0},O=()=>{if(k.value.cover==""){q.error("请先上传图片");return}Re(g.value,1).then(l=>{l.state==200?(k.value=l.data,R(k.value.completion)):q.error(l.message)})},_=l=>{ke(l).then(s=>{s.state==200?k.value=s.data:q.error(s.message)})};return le(()=>{g.value=p.courseId,console.log(g.value),_(g.value)}),(l,s)=>{const y=xe("Plus"),N=Le,w=be,c=oe,z=se;return n(),f("div",pt,[V("div",vt,[e(w,{class:"cover-uploader",action:"/dev-api/content/add_cover/"+g.value,headers:L.value,"show-file-list":!1,"on-success":h,"before-upload":v},{default:t(()=>[k.value.cover?(n(),f("img",{key:0,src:"/local-resource/image/"+k.value.cover,class:"cover"},null,8,ct)):(n(),U(N,{key:1,class:"cover-uploader-icon"},{default:t(()=>[e(y)]),_:1}))]),_:1},8,["action","headers"])]),e(z,{class:"bottom-row"},{default:t(()=>[e(c,{onClick:$},{default:t(()=>s[1]||(s[1]=[x("上一步",-1)])),_:1,__:[1]}),e(c,{type:"primary",onClick:s[0]||(s[0]=P=>O())},{default:t(()=>s[2]||(s[2]=[x("下一步",-1)])),_:1,__:[2]})]),_:1})])}}});const ft=re(_t,[["__scopeId","data-v-f5d4ade9"]]),gt={id:"pane-third",class:"pane",key:"1"},kt={class:"cover-upload"},bt=["src"],yt=te({__name:"three",props:{courseId:Number},emits:["nextStep","lastStep"],setup(M,{emit:J}){const p=M,g=r({"x-access-token":localStorage.getItem("x-access-token"),"x-access-type":localStorage.getItem("x-access-type")}),L=r(0),k=r({id:null,name:"",introduction:"",introduce:"",target:"",cover:"",completion:null,guidance:"",fourth:"",third:1}),D=J,R=l=>{D("nextStep",l)},$=()=>{D("lastStep")},h=(l,s)=>{l.state==200&&(k.value.fourth=l.data.filename)},v=l=>(L.value==0&&q.error("数据异常"),l.type!="image/png"?(q.error("请上传PNG类型的图片"),!1):l.size/1024/1024>1?(q.error("图片最大 1MB!"),!1):!0),O=()=>{if(k.value.fourth==""){q.error("请先上传图片");return}Re(L.value,2).then(l=>{l.state==200?(k.value=l.data,R(k.value.completion)):q.error(l.message)})},_=l=>{ke(l).then(s=>{s.state==200?k.value=s.data:q.error(s.message)})};return le(()=>{L.value=p.courseId,_(L.value)}),(l,s)=>{const y=xe("Plus"),N=Le,w=be,c=oe,z=se;return n(),f("div",gt,[V("div",kt,[e(w,{class:"cover-uploader",action:"/dev-api/content/add_fourth/"+L.value,headers:g.value,"show-file-list":!1,"on-success":h,"before-upload":v},{default:t(()=>[k.value.fourth?(n(),f("img",{key:0,src:"/local-resource/image/"+k.value.fourth,class:"cover"},null,8,bt)):(n(),U(N,{key:1,class:"cover-uploader-icon"},{default:t(()=>[e(y)]),_:1}))]),_:1},8,["action","headers"])]),e(z,{class:"bottom-row"},{default:t(()=>[e(c,{onClick:$},{default:t(()=>s[1]||(s[1]=[x("上一步",-1)])),_:1,__:[1]}),e(c,{type:"primary",onClick:s[0]||(s[0]=P=>O())},{default:t(()=>s[2]||(s[2]=[x("下一步",-1)])),_:1,__:[2]})]),_:1})])}}});const xt=re(yt,[["__scopeId","data-v-133fdb6c"]]),Lt={id:"pane-fourth",class:"pane",key:"3"},Ct={style:{margin:"30px 0px"}},wt={key:0},St={key:0},Dt={style:{margin:"30px 0px"}},$t={key:0},Vt={key:0},Tt=te({__name:"four",props:{courseId:Number},emits:["nextStep","lastStep"],setup(M,{emit:J}){const p=M;le(()=>{D.value=p.courseId,$()});const g=J,L=o=>{g("nextStep",o)},k=()=>{g("lastStep")},D=r(0),R=r([]),$=()=>{at(D.value).then(o=>{o.state==200?R.value=o.data:q.error("获取课程设计内容异常")})},h=r(),v=r({id:null,graduationRequirementName:"",graduationPointList:[],courseTargetList:[]}),O=ce({graduationRequirementName:[{required:!0,message:"请输入毕业要求",trigger:"blur"}],graduationPointList:[{required:!0,validator:function(o,a,b){a[0].point==""?b(new Error("没有对应的毕业要求指标点")):b()},trigger:"change"}],courseTargetList:[{required:!0,validator:function(o,a,b){a[0].point==""?b(new Error("没有对应的课程目标")):b()},trigger:"change"}]}),_=r(""),l=r("");r("");const s=()=>{if(_.value=="")return;let o=r({id:null,parentId:null,name:_.value});v.value.graduationPointList.push(o.value),_.value=""},y=o=>{v.value.graduationPointList.splice(o,1)},N=()=>{if(l.value=="")return;let o=r({id:null,parentId:null,name:l.value});v.value.courseTargetList.push(o.value),l.value=""},w=o=>{v.value.courseTargetList.splice(o,1)},c=async o=>{o&&await o.validate((a,b)=>{if(a){let E=Object.assign({},v.value);tt(D.value,E).then(K=>{K.state==200?(R.value=K.data,z()):q.error(K.message)})}})},z=()=>{v.value.graduationRequirementName="",v.value.graduationPointList.splice(0,v.value.graduationPointList.length),v.value.courseTargetList.splice(0,v.value.courseTargetList.length)},P=o=>{lt(D.value,o).then(a=>{a.state==200?R.value=a.data:q.error(a.message)})},Q=()=>{We(D.value).then(o=>{if(o.state==200){let a=o.data.completion;L(a)}else q.error(o.message)})};return(o,a)=>{const b=Ce,E=oe,K=we,de=Se,I=_e,m=me,u=ye,F=pe,X=De,ae=se;return n(),f("div",Lt,[a[13]||(a[13]=V("div",{style:{margin:"20px 0px"}},[V("span",null," 本节需要明确课程目标和对应知识点的匹配关系 ")],-1)),V("div",Ct,[e(de,{data:R.value,border:!0,style:{width:"100%"}},{default:t(()=>[e(b,{prop:"graduationRequirementName",label:"毕业要求"}),e(b,{label:"毕业要求指标点"},{default:t(T=>[R.value.length>0&&R.value[0]!=null?(n(),f("div",wt,[(n(!0),f(j,null,B(T.row.graduationPointList.length,Y=>(n(),f("li",null,G(T.row.graduationPointList[Y-1].name),1))),256))])):A("",!0)]),_:1}),e(b,{label:"对应的课程目标"},{default:t(T=>[R.value.length>0&&R.value[0]!=null?(n(),f("div",St,[(n(!0),f(j,null,B(T.row.courseTargetList.length,Y=>(n(),f("li",null,G(T.row.courseTargetList[Y-1].name),1))),256))])):A("",!0)]),_:1}),e(b,{prop:"",label:"操作",width:"100px"},{default:t(T=>[e(K,{title:"确定删除吗?",onConfirm:Y=>P(T.row.graduationRequirementId)},{reference:t(()=>[e(E,{link:"",type:"danger",size:"small",icon:H(fe)},null,8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),V("div",Dt,[e(X,{style:{"min-height":"280px"},shadow:"never"},{header:t(()=>a[8]||(a[8]=[V("div",null,[V("span",null,"添加课程目标和对应知识点匹配关系")],-1)])),default:t(()=>[V("div",null,[e(F,{"label-width":"160px",ref_key:"designFormRef",ref:h,model:v.value,rules:O},{default:t(()=>[e(m,{label:"毕业要求：",prop:"graduationRequirementName"},{default:t(()=>[e(I,{modelValue:v.value.graduationRequirementName,"onUpdate:modelValue":a[0]||(a[0]=T=>v.value.graduationRequirementName=T),style:{"max-width":"500px"},placeholder:"请输入毕业要求"},null,8,["modelValue"])]),_:1}),e(m,{label:"毕业要求指标点：",prop:"graduationPointList"},{default:t(()=>[v.value.graduationPointList.length>0?(n(),f("div",$t,[(n(!0),f(j,null,B(v.value.graduationPointList.length,T=>(n(),U(u,{key:T,class:"mx-1",closable:"",onClose:Y=>y(T-1)},{default:t(()=>[x(G(v.value.graduationPointList[T-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(m,null,{default:t(()=>[e(I,{style:{"max-width":"500px","margin-right":"20px"},modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=T=>_.value=T),placeholder:"请分条输入毕业要求对应指标点，每一条完成后点击右侧保存"},null,8,["modelValue"]),e(E,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:a[2]||(a[2]=T=>s())},null,8,["icon"])]),_:1}),e(m,{label:"对应课程目标：",prop:"graduationPointList"},{default:t(()=>[v.value.courseTargetList.length>0?(n(),f("div",Vt,[(n(!0),f(j,null,B(v.value.courseTargetList.length,T=>(n(),U(u,{key:T,class:"mx-1",closable:"",onClose:Y=>w(T-1)},{default:t(()=>[x(G(v.value.courseTargetList[T-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(m,null,{default:t(()=>[e(I,{style:{"max-width":"500px","margin-right":"20px"},modelValue:l.value,"onUpdate:modelValue":a[3]||(a[3]=T=>l.value=T),placeholder:"请分条输入毕业要求对应课程目标，每一条完成后点击右侧保存"},null,8,["modelValue"]),e(E,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:a[4]||(a[4]=T=>N())},null,8,["icon"])]),_:1}),e(m,null,{default:t(()=>[e(E,{type:"primary",size:"small",onClick:a[5]||(a[5]=T=>c(h.value))},{default:t(()=>a[9]||(a[9]=[x("添加",-1)])),_:1,__:[9]}),e(E,{size:"small",onClick:a[6]||(a[6]=T=>z())},{default:t(()=>a[10]||(a[10]=[x("清除内容",-1)])),_:1,__:[10]})]),_:1})]),_:1},8,["model","rules"])])]),_:1})]),e(ae,{class:"bottom-row"},{default:t(()=>[e(E,{onClick:k},{default:t(()=>a[11]||(a[11]=[x("上一步",-1)])),_:1,__:[11]}),e(E,{type:"primary",onClick:a[7]||(a[7]=T=>Q())},{default:t(()=>a[12]||(a[12]=[x("下一步",-1)])),_:1,__:[12]})]),_:1})])}}});const It=re(Tt,[["__scopeId","data-v-4f86a28c"]]),qt={key:0},Rt={key:0},Nt={key:0},ht={key:0},Ut={style:{"margin-left":"150px"}},Et=te({__name:"noDevice",props:{courseId:Number,isEdit:Boolean,oldTaskTemplate:Object},emits:["addSuccess","exitUpdate"],setup(M,{emit:J}){const p=M,g=r(0);le(()=>{g.value=p.courseId,p.isEdit&&(o.value=p.oldTaskTemplate)});const L=J,k=I=>{L("addSuccess",I)},D=()=>{L("exitUpdate")},R=r(),$=r({id:null,name:"",url:""}),h=ce({name:[{required:!0,message:"请输入参考链接名称",trigger:"blur"}],url:[{required:!0,message:"请输入参考链接URL",trigger:"blur"}]}),v=async I=>{I&&await I.validate((m,u)=>{if(m){let F=Object.assign({},$.value);o.value.referenceLinkList.push(F),$.value.name="",$.value.url=""}else console.log("error submit!",u)})},O=I=>{o.value.referenceLinkList.splice(I,1)},_=r(""),l=()=>{if(_.value=="")return;let I=r({id:null,name:_.value});o.value.backDropList.length>0&&o.value.backDropList[0]==null?o.value.backDropList[0]=I.value:o.value.backDropList.push(I.value),_.value=""},s=I=>{o.value.backDropList.splice(I,1)},y=r(""),N=()=>{if(y.value!=""){let I=r({id:null,name:y.value});o.value.requirementList.length>0&&o.value.requirementList[0]==null?o.value.requirementList[0]=I.value:o.value.requirementList.push(I.value),y.value=""}},w=I=>{o.value.requirementList.splice(I,1)},c=r(""),z=()=>{if(c.value!=""){let I=r({id:null,name:c.value});o.value.deliverableRequirementList.length>0&&o.value.deliverableRequirementList[0]==null?o.value.deliverableRequirementList[0]=I.value:o.value.deliverableRequirementList.push(I.value),c.value=""}},P=I=>{o.value.deliverableRequirementList.splice(I,1)},Q=r(),o=r({id:null,contentId:g.value,num:null,taskName:"",taskCover:"",taskDevice:null,taskDataTables:null,backDropList:[],requirementList:[],deliverableRequirementList:[],referenceLinkList:[],referenceFileList:[]}),a=ce({taskName:[{required:!0,message:"请输入实验名称",trigger:"blur"}],num:[{required:!0,message:"请输入实验序号",trigger:"blur"}],requirementList:[{required:!0,validator:function(I,m,u){m[0].point==""?u(new Error("没有实验要求")):u()},trigger:"change"}],deliverableRequirementList:[{required:!0,validator:function(I,m,u){m[0].point==""?u(new Error("没有实验交付物要求")):u()},trigger:"change"}]}),b=async I=>{I&&await I.validate((m,u)=>{if(m){o.value.contentId=g.value;let F=Object.assign({},o.value);he(F).then(X=>{X.state==200?(E(),k(X.data)):q.error(X.message)})}else console.log("error submit!",u)})},E=()=>{o.value.taskName="",o.value.num=null,o.value.taskCover="",o.value.backDropList=[],o.value.deliverableRequirementList=[],o.value.requirementList=[],o.value.referenceLinkList=[],o.value.taskDevice=null,o.value.taskDataTables=null},K=async I=>{I&&await I.validate((m,u)=>{if(m){let F=Object.assign({},o.value);Ue(F).then(X=>{X.state==200?(E(),k(X.data),D(),q.success("更新成功")):q.error(X.message)})}else console.log("error submit!",u)})},de=()=>{E(),D()};return(I,m)=>{const u=_e,F=me,X=Ie,ae=ye,T=oe,Y=pe;return n(),f("div",null,[e(Y,{"label-width":"150px",ref_key:"addTaskFormRef",ref:Q,model:o.value,rules:a},{default:t(()=>[e(F,{label:"实验名称：",prop:"taskName"},{default:t(()=>[e(u,{style:{"max-width":"400px","margin-right":"20px"},modelValue:o.value.taskName,"onUpdate:modelValue":m[0]||(m[0]=C=>o.value.taskName=C),placeholder:"请输入实验名称"},null,8,["modelValue"])]),_:1}),e(F,{label:"实验序号：",prop:"num"},{default:t(()=>[e(X,{min:1,max:10,modelValue:o.value.num,"onUpdate:modelValue":m[1]||(m[1]=C=>o.value.num=C)},null,8,["modelValue"])]),_:1}),e(F,{label:"实验背景：",prop:""},{default:t(()=>[o.value.backDropList.length>0?(n(),f("div",qt,[(n(!0),f(j,null,B(o.value.backDropList.length,C=>(n(),U(ae,{closable:"",key:C,class:"mx-1",onClose:i=>s(C-1)},{default:t(()=>[x(G(o.value.backDropList[C-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(F,null,{default:t(()=>[e(u,{style:{"max-width":"400px","margin-right":"20px"},modelValue:_.value,"onUpdate:modelValue":m[2]||(m[2]=C=>_.value=C),placeholder:"请分条输入实验背景，每一条完成后点击右侧保存"},null,8,["modelValue"]),e(T,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:m[3]||(m[3]=C=>l())},null,8,["icon"])]),_:1}),e(F,{label:"实验目的：",prop:"requirementList"},{default:t(()=>[o.value.requirementList.length>0?(n(),f("div",Rt,[(n(!0),f(j,null,B(o.value.requirementList.length,C=>(n(),U(ae,{closable:"",key:C,class:"mx-1",onClose:i=>w(C-1)},{default:t(()=>[x(G(o.value.requirementList[C-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(F,null,{default:t(()=>[e(u,{style:{"max-width":"400px","margin-right":"20px"},modelValue:y.value,"onUpdate:modelValue":m[4]||(m[4]=C=>y.value=C),placeholder:"请分条输入实验目的，每一条完成后点击右侧保存"},null,8,["modelValue"]),e(T,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:m[5]||(m[5]=C=>N())},null,8,["icon"])]),_:1}),e(F,{label:"实验要求：",prop:"deliverableRequirementList"},{default:t(()=>[o.value.deliverableRequirementList.length>0?(n(),f("div",Nt,[(n(!0),f(j,null,B(o.value.deliverableRequirementList.length,C=>(n(),U(ae,{closable:"",class:"mx-1",key:C,onClose:i=>P(C-1)},{default:t(()=>[x(G(o.value.deliverableRequirementList[C-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(F,null,{default:t(()=>[e(u,{style:{"max-width":"400px","margin-right":"20px"},modelValue:c.value,"onUpdate:modelValue":m[6]||(m[6]=C=>c.value=C),placeholder:"请分条输入实验交付物要求，每一条完成后点击右侧保存"},null,8,["modelValue"]),e(T,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:m[7]||(m[7]=C=>z())},null,8,["icon"])]),_:1}),e(F,{label:"实验参考链接：",prop:"referenceLinkList"},{default:t(()=>[o.value.referenceLinkList.length>0?(n(),f("div",ht,[(n(!0),f(j,null,B(o.value.referenceLinkList.length,C=>(n(),U(ae,{closable:"",class:"mx-1",key:C,onClose:i=>O(C-1)},{default:t(()=>[x(G(o.value.referenceLinkList[C-1].name+"："+o.value.referenceLinkList[C-1].url),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),V("div",Ut,[e(Y,{"label-width":"80px",ref_key:"addReferenceLinkRef",ref:R,model:$.value,rules:h},{default:t(()=>[e(F,{label:"名称：",prop:"name"},{default:t(()=>[e(u,{style:{"max-width":"320px","margin-right":"20px"},modelValue:$.value.name,"onUpdate:modelValue":m[8]||(m[8]=C=>$.value.name=C),placeholder:"请分条输入实验参考链接的名称和URL"},null,8,["modelValue"])]),_:1}),e(F,{label:"url：",prop:"url"},{default:t(()=>[e(u,{style:{"max-width":"320px","margin-right":"20px"},modelValue:$.value.url,"onUpdate:modelValue":m[9]||(m[9]=C=>$.value.url=C),placeholder:"输入完成点击右侧保存"},null,8,["modelValue"]),e(T,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:m[10]||(m[10]=C=>v(R.value))},null,8,["icon"])]),_:1})]),_:1},8,["model","rules"])]),p.isEdit?(n(),U(F,{key:1,style:{"margin-top":"50px"}},{default:t(()=>[e(T,{type:"primary",size:"small",onClick:m[13]||(m[13]=C=>K(Q.value))},{default:t(()=>m[17]||(m[17]=[x("完成",-1)])),_:1,__:[17]}),e(T,{size:"small",onClick:m[14]||(m[14]=C=>de())},{default:t(()=>m[18]||(m[18]=[x("取消",-1)])),_:1,__:[18]})]),_:1})):(n(),U(F,{key:0,style:{"margin-top":"50px"}},{default:t(()=>[e(T,{type:"primary",size:"small",onClick:m[11]||(m[11]=C=>b(Q.value))},{default:t(()=>m[15]||(m[15]=[x("添加实验",-1)])),_:1,__:[15]}),e(T,{size:"small",onClick:m[12]||(m[12]=C=>E())},{default:t(()=>m[16]||(m[16]=[x("清除内容",-1)])),_:1,__:[16]})]),_:1}))]),_:1},8,["model","rules"])])}}});const Ft=re(Et,[["__scopeId","data-v-028225d4"]]),zt={style:{"margin-top":"30px"}},Ot={class:"dialog-footer"},Pt=te({__name:"table",props:{tableDate:{}},setup(M){le(()=>{p.value=J.tableDate});const J=M,p=r({id:null,name:"",params:[],columnList:[],rowData:[]});console.log(p);const g=()=>{console.log(p)},L=()=>{p.value.rowData.push({});for(let _=0;_<p.value.columnList.length;_++)p.value.rowData.slice(-1)["data"+_]=null;g()},k=()=>{let _=p.value.columnList.length;p.value.columnList.push({prop:"data"+_,label:"测量值"+_});for(let l=0;l<p.value.rowData.length;l++)p.value.rowData[l]["data"+_]=null;g()},D=_=>{p.value.rowData.splice(_,1),g()},R=()=>{let _=p.value.columnList.length;p.value.columnList.splice(_-1,1);for(let l=0;l<p.value.rowData.length;l++)delete p.value.rowData[l]["data"+_];g()},$=_=>{p.value.params.splice(_,1),g()},h=r(!1),v=r({name:"",value:null}),O=()=>{v.value.name!=""&&v.value.value!=null&&(p.value.params.push(Object.assign({},v.value)),v.value.name="",v.value.value=null,h.value=!1,g())};return(_,l)=>{const s=_e,y=me,N=oe,w=ye,c=se,z=pe,P=Ce,Q=Se,o=Oe;return n(),f("div",zt,[V("div",null,[e(z,{model:p.value,"label-width":"100px","label-position":"left",style:{"max-width":"500px"}},{default:t(()=>[e(y,{label:"表名："},{default:t(()=>[e(s,{modelValue:p.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>p.value.name=a),placeholder:"请输入表名"},null,8,["modelValue"])]),_:1}),e(y,{label:"固定参数："},{default:t(()=>[e(N,{type:"primary",size:"small",onClick:l[1]||(l[1]=a=>h.value=!0)},{default:t(()=>l[7]||(l[7]=[x("添加",-1)])),_:1,__:[7]})]),_:1}),e(y,null,{default:t(()=>[e(c,null,{default:t(()=>[(n(!0),f(j,null,B(p.value.params.length,a=>(n(),U(w,{key:a,style:{"margin-right":"10px","margin-bottom":"20px"},closable:"",onClose:b=>$(a-1)},{default:t(()=>[x(G(p.value.params[a-1].name)+"："+G(p.value.params[a-1].value),1)]),_:2},1032,["onClose"]))),128))]),_:1})]),_:1})]),_:1},8,["model"])]),e(Q,{style:{"margin-top":"10px","margin-bottom":"20px"},data:p.value.rowData,border:"","row-style":{flexGrow:1}},{default:t(()=>[(n(!0),f(j,null,B(p.value.columnList.length,a=>(n(),U(P,{key:p.value.columnList[a-1].prop,align:"center"},{header:t(()=>[e(c,{style:{"flex-wrap":"nowrap"}},{default:t(()=>[e(s,{modelValue:p.value.columnList[a-1].label,"onUpdate:modelValue":b=>p.value.columnList[a-1].label=b},null,8,["modelValue","onUpdate:modelValue"]),a==p.value.columnList.length&&a>2?(n(),U(N,{key:0,style:{"margin-bottom":"2px"},type:"danger",icon:H(fe),link:"",onClick:R},null,8,["icon"])):A("",!0)]),_:2},1024)]),default:t(({row:b})=>[e(s,{type:"text",modelValue:b[p.value.columnList[a-1].prop],"onUpdate:modelValue":E=>b[p.value.columnList[a-1].prop]=E,onChange:g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128)),e(P,{align:"center",width:"200"},{header:t(()=>[e(N,{type:"primary",size:"small",onClick:L},{default:t(()=>l[8]||(l[8]=[x("添加行",-1)])),_:1,__:[8]}),e(N,{type:"primary",size:"small",onClick:k},{default:t(()=>l[9]||(l[9]=[x("添加列",-1)])),_:1,__:[9]})]),default:t(a=>[e(N,{type:"danger",size:"small",onClick:b=>D(a.$index)},{default:t(()=>l[10]||(l[10]=[x("删除行",-1)])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(o,{modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=a=>h.value=a),title:"添加固定参数",width:"500"},{footer:t(()=>[V("div",Ot,[e(N,{onClick:l[4]||(l[4]=a=>h.value=!1)},{default:t(()=>l[11]||(l[11]=[x("取消",-1)])),_:1,__:[11]}),e(N,{type:"primary",onClick:l[5]||(l[5]=a=>O())},{default:t(()=>l[12]||(l[12]=[x(" 确定 ",-1)])),_:1,__:[12]})])]),default:t(()=>[e(z,{model:v.value},{default:t(()=>[e(y,{label:"参数名","label-width":"100px"},{default:t(()=>[e(s,{modelValue:v.value.name,"onUpdate:modelValue":l[2]||(l[2]=a=>v.value.name=a),placeholder:"请输入参数名"},null,8,["modelValue"])]),_:1}),e(y,{label:"参数值","label-width":"100px"},{default:t(()=>[e(s,{modelValue:v.value.value,"onUpdate:modelValue":l[3]||(l[3]=a=>v.value.value=a),placeholder:"请输入参数值"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const jt={key:0},Bt={key:0},Jt={key:0},Gt={key:0},At={style:{"margin-left":"120px"}},Qt={style:{"text-align":"right"}},Mt={style:{"margin-left":"120px"}},Ht=te({__name:"iecube3835",props:{courseId:Number,device:Object,isEdit:Boolean,oldTaskTemplate:Object},emits:["addSuccess","exitUpdate"],setup(M,{emit:J}){const p=M,g=r(0),L=r();le(()=>{g.value=p.courseId,L.value=p.device,v(),p.isEdit&&(u.value=p.oldTaskTemplate,(u.value.taskDetails!=null||u.value.taskDetails!="")&&(F.value=JSON.parse(u.value.taskDetails),h.value=JSON.parse(F.value.taskDataTables),E.value=JSON.parse(F.value.taskQestion)))});const k=J,D=i=>{k("addSuccess",i)},R=()=>{k("exitUpdate")},$=r(null),h=r([]),v=()=>{$.value=JSON.parse(L.value.basicDataTable);let i=JSON.parse(JSON.stringify($.value));i.id=Date.now(),h.value.push(i)},O=()=>{let i=JSON.parse(JSON.stringify($.value));i.id=Date.now(),h.value.push(i)},_=i=>{h.value.splice(i,1)},l=r(""),s=()=>{if(l.value=="")return;let i=r({id:null,name:l.value});u.value.backDropList.length>0&&u.value.backDropList[0]==null?u.value.backDropList[0]=i.value:u.value.backDropList.push(i.value),l.value=""},y=i=>{u.value.backDropList.splice(i,1)},N=r(""),w=()=>{if(N.value!=""){let i=r({id:null,name:N.value});u.value.requirementList.length>0&&u.value.requirementList[0]==null?u.value.requirementList[0]=i.value:u.value.requirementList.push(i.value),N.value=""}},c=i=>{u.value.requirementList.splice(i,1)},z=r(""),P=()=>{if(z.value!=""){let i=r({id:null,name:z.value});u.value.experimentalSubjectList.length>0&&u.value.experimentalSubjectList[0]==null?u.value.experimentalSubjectList[0]=i.value:u.value.experimentalSubjectList.push(i.value),z.value=""}},Q=i=>{u.value.experimentalSubjectList.splice(i,1)},o=r(""),a=()=>{if(o.value!=""){let i=r({id:null,name:o.value});u.value.attentionList.length>0&&u.value.attentionList[0]==null?u.value.attentionList[0]=i.value:u.value.attentionList.push(i.value),o.value=""}},b=i=>{u.value.attentionList.splice(i,1)},E=r([]),K=r(""),de=()=>{if(K.value!=""){let i=r({id:null,question:K.value,answer:null});E.value.push(i.value),K.value=""}},I=i=>{E.value.splice(i,1)},m=r(),u=r({id:null,contentId:g.value,num:null,taskName:"",taskCover:"",taskDevice:null,taskDetails:null,backDropList:[],requirementList:[],deliverableRequirementList:[],referenceLinkList:[],referenceFileList:[],experimentalSubjectList:[],attentionList:[]}),F=r({taskDataTables:"",taskQestion:""}),X=ce({taskName:[{required:!0,message:"请输入实验名称",trigger:"blur"}],num:[{required:!0,message:"请输入实验序号",trigger:"blur"}]}),ae=async i=>{i&&await i.validate((d,ne)=>{if(d){u.value.contentId=g.value,u.value.taskDevice=L.value.id,F.value.taskDataTables=JSON.stringify(h.value),F.value.taskQestion=JSON.stringify(E.value),u.value.taskDetails=JSON.stringify(F.value);let W=Object.assign({},u.value);he(W).then(ue=>{ue.state==200?(C(),D(ue.data),q.success("添加成功")):q.error(ue.message)})}else console.log("error submit!",ne)})},T=async i=>{i&&await i.validate((d,ne)=>{if(d){F.value.taskDataTables=JSON.stringify(h.value),F.value.taskQestion=JSON.stringify(E.value),u.value.taskDetails=JSON.stringify(F.value);let W=Object.assign({},u.value);Ue(W).then(ue=>{ue.state==200?(C(),D(ue.data),R(),q.success("更新成功")):q.error(ue.message)})}else console.log("error submit!",ne)})},Y=()=>{C(),R()},C=()=>{u.value.taskName="",u.value.num=null,u.value.taskCover="",u.value.backDropList=[],u.value.deliverableRequirementList=[],u.value.requirementList=[],u.value.referenceLinkList=[],u.value.experimentalSubjectList=[],u.value.attentionList=[],u.value.taskDetails=null,h.value=[],v(),E.value=[]};return(i,d)=>{const ne=_e,W=me,ue=Ie,ve=ye,Z=oe,ge=se,Ee=De,$e=qe,Fe=pe;return n(),f("div",null,[e(Fe,{"label-width":"150px",ref_key:"addTaskFormRef",ref:m,model:u.value,rules:X},{default:t(()=>[e(W,{label:"实验名称：",prop:"taskName"},{default:t(()=>[e(ne,{style:{"max-width":"400px","margin-right":"20px"},modelValue:u.value.taskName,"onUpdate:modelValue":d[0]||(d[0]=S=>u.value.taskName=S),placeholder:"请输入实验名称"},null,8,["modelValue"])]),_:1}),e(W,{label:"实验序号：",prop:"num"},{default:t(()=>[e(ue,{min:1,max:10,modelValue:u.value.num,"onUpdate:modelValue":d[1]||(d[1]=S=>u.value.num=S)},null,8,["modelValue"])]),_:1}),e(W,{label:"实验背景：",prop:""},{default:t(()=>[u.value.backDropList.length>0?(n(),f("div",jt,[(n(!0),f(j,null,B(u.value.backDropList.length,S=>(n(),U(ve,{closable:"",key:S,class:"mx-1",onClose:ie=>y(S-1)},{default:t(()=>[x(G(u.value.backDropList[S-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(W,null,{default:t(()=>[e(ne,{style:{"max-width":"400px","margin-right":"20px"},modelValue:l.value,"onUpdate:modelValue":d[2]||(d[2]=S=>l.value=S),placeholder:"添加实验背景"},null,8,["modelValue"]),e(Z,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:d[3]||(d[3]=S=>s())},null,8,["icon"])]),_:1}),e(W,{label:"实验目的：",prop:"requirementList"},{default:t(()=>[u.value.requirementList.length>0?(n(),f("div",Bt,[(n(!0),f(j,null,B(u.value.requirementList.length,S=>(n(),U(ve,{closable:"",key:S,class:"mx-1",onClose:ie=>c(S-1)},{default:t(()=>[x(G(u.value.requirementList[S-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(W,null,{default:t(()=>[e(ne,{style:{"max-width":"400px","margin-right":"20px"},modelValue:N.value,"onUpdate:modelValue":d[4]||(d[4]=S=>N.value=S),placeholder:"添加实验目的"},null,8,["modelValue"]),e(Z,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:d[5]||(d[5]=S=>w())},null,8,["icon"])]),_:1}),e(W,{label:"实验器件：",prop:"experimentalSubjectList"},{default:t(()=>[u.value.experimentalSubjectList.length>0?(n(),f("div",Jt,[(n(!0),f(j,null,B(u.value.experimentalSubjectList.length,S=>(n(),U(ve,{closable:"",key:S,class:"mx-1",onClose:ie=>Q(S-1)},{default:t(()=>[x(G(u.value.experimentalSubjectList[S-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(W,null,{default:t(()=>[e(ne,{style:{"max-width":"400px","margin-right":"20px"},modelValue:z.value,"onUpdate:modelValue":d[6]||(d[6]=S=>z.value=S),placeholder:"添加实验器件"},null,8,["modelValue"]),e(Z,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:d[7]||(d[7]=S=>P())},null,8,["icon"])]),_:1}),e(W,{label:"实验注意事项：",prop:"attentionList"},{default:t(()=>[u.value.attentionList.length>0?(n(),f("div",Gt,[(n(!0),f(j,null,B(u.value.attentionList.length,S=>(n(),U(ve,{closable:"",key:S,class:"mx-1",onClose:ie=>b(S-1)},{default:t(()=>[x(G(u.value.attentionList[S-1].name),1)]),_:2},1032,["onClose"]))),128))])):A("",!0)]),_:1}),e(W,null,{default:t(()=>[e(ne,{style:{"max-width":"400px","margin-right":"20px"},modelValue:o.value,"onUpdate:modelValue":d[8]||(d[8]=S=>o.value=S),placeholder:"添加实验注意事项"},null,8,["modelValue"]),e(Z,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:d[9]||(d[9]=S=>a())},null,8,["icon"])]),_:1}),e(W,{label:"实验内容："}),V("div",At,[e(ge,null,{default:t(()=>[d[18]||(d[18]=V("span",null,"操作设备实验数据记录信息（请完善表格必要信息，表格将在学生操作设备时交由学生填写记录）:",-1)),e(Z,{style:{"margin-left":"20px"},type:"primary",size:"small",onClick:d[10]||(d[10]=S=>O())},{default:t(()=>d[17]||(d[17]=[x("添加表格",-1)])),_:1,__:[17]})]),_:1,__:[18]}),(n(!0),f(j,null,B(h.value,(S,ie)=>(n(),U(Ee,{style:{"margin-top":"20px"},key:S.id,shadow:"never"},{header:t(()=>[V("div",Qt,[e(Z,{type:"danger",link:"",icon:H(fe),onClick:ze=>_(ie-1)},null,8,["icon","onClick"])])]),default:t(()=>[(n(),U(Pt,{"table-date":S,key:"dataTable"+ie},null,8,["table-date"]))]),_:2},1024))),128))]),V("div",Mt,[e(ge,{style:{"margin-top":"20px","margin-bottom":"20px"}},{default:t(()=>d[19]||(d[19]=[V("span",null,"实验思考题：",-1)])),_:1,__:[19]}),(n(!0),f(j,null,B(E.value,(S,ie)=>(n(),U(ge,{style:{"margin-top":"10px","margin-bottom":"10px"},key:ie},{default:t(()=>[e(ve,{closable:"",class:"mx-1",onClose:ze=>I(ie)},{default:t(()=>[x(G(S.question),1)]),_:2},1032,["onClose"])]),_:2},1024))),128)),e(ge,null,{default:t(()=>[e($e,{span:21},{default:t(()=>[e(ne,{modelValue:K.value,"onUpdate:modelValue":d[11]||(d[11]=S=>K.value=S),placeholder:"添加实验思考题"},null,8,["modelValue"])]),_:1}),e($e,{span:3,style:{"padding-left":"20px"}},{default:t(()=>[e(Z,{type:"primary",circle:"",size:"small",icon:H(ee),onClick:d[12]||(d[12]=S=>de())},null,8,["icon"])]),_:1})]),_:1})]),p.isEdit?(n(),U(W,{key:1,style:{"margin-top":"50px"}},{default:t(()=>[e(Z,{type:"primary",size:"small",onClick:d[15]||(d[15]=S=>T(m.value))},{default:t(()=>d[22]||(d[22]=[x("完成",-1)])),_:1,__:[22]}),e(Z,{size:"small",onClick:d[16]||(d[16]=S=>Y())},{default:t(()=>d[23]||(d[23]=[x("取消",-1)])),_:1,__:[23]})]),_:1})):(n(),U(W,{key:0,style:{"margin-top":"50px"}},{default:t(()=>[e(Z,{type:"primary",size:"small",onClick:d[13]||(d[13]=S=>ae(m.value))},{default:t(()=>d[20]||(d[20]=[x("添加实验",-1)])),_:1,__:[20]}),e(Z,{size:"small",onClick:d[14]||(d[14]=S=>C())},{default:t(()=>d[21]||(d[21]=[x("清除内容",-1)])),_:1,__:[21]})]),_:1}))]),_:1},8,["model","rules"])])}}});const Kt=re(Ht,[["__scopeId","data-v-e340de80"]]),Wt={id:"pane-fiveth",class:"pane",key:"4"},Xt={style:{margin:"30px 0px"}},Yt={style:{display:"flex","justify-content":"center"}},Zt={style:{margin:"30px 0px"}},el={key:0},tl={key:1},ll=te({__name:"five",props:{courseId:Number},emits:["nextStep","lastStep"],setup(M,{emit:J}){const p=M,g=r({"x-access-token":localStorage.getItem("x-access-token"),"x-access-type":localStorage.getItem("x-access-type")}),L=r(0);le(()=>{L.value=p.courseId,k(L.value),D()});const k=a=>{nt(a).then(b=>{b.state==200?s.value=b.data:q.error("获取课程实验列表异常")})},D=()=>{Ne().then(a=>{a.state==200?l.value=a.data:q.error("获取iecube设备列表异常")})},R=J,$=a=>{R("nextStep",a)},h=()=>{R("lastStep")},v=r(0),O=r(),_=()=>{for(let a=0;a<l.value.length;a++)l.value[a].id==v.value&&(O.value=l.value[a]);console.log(O.value)},l=r([]),s=r([]),y=a=>{console.log("添加成功"),console.log(a),s.value=a},N=()=>{P.value=!1},w=(a,b)=>{a.state==200&&(s.value=a.data)},c=a=>{ot(L.value,a).then(b=>{b.state==200?s.value=b.data:q.error(b.message)})},z=()=>{Xe(L.value).then(a=>{if(a.state==200){let b=a.data.completion;$(b)}else q.error(a.message)})},P=r(!1),Q=r(),o=a=>{console.log(s.value[a]),s.value[a].taskDevice!=null?v.value=JSON.parse(JSON.stringify(s.value[a].taskDevice)):v.value=0,Q.value=JSON.parse(JSON.stringify(s.value[a])),P.value=!0,_()};return(a,b)=>{const E=Ce,K=oe,de=be,I=we,m=Se,u=Ve,F=Te,X=me,ae=pe,T=je,Y=De,C=se;return n(),f("div",Wt,[b[9]||(b[9]=V("div",{style:{margin:"30px 0px"}},[V("span",null,"本节需要完善该课程的实验模版")],-1)),V("div",Xt,[e(m,{data:s.value,border:!0,style:{width:"100%"}},{default:t(()=>[e(E,{prop:"num",label:"实验序号",width:"60px"}),e(E,{prop:"taskName",label:"实验名称"}),e(E,{label:"实验背景"},{default:t(i=>[V("ol",null,[(n(!0),f(j,null,B(i.row.backDropList.length,d=>(n(),f("li",{key:d},G(i.row.backDropList[d-1].name),1))),128))])]),_:1}),e(E,{label:"实验要求"},{default:t(i=>[V("ol",null,[(n(!0),f(j,null,B(i.row.requirementList.length,d=>(n(),f("li",{key:d},G(i.row.requirementList[d-1].name),1))),128))])]),_:1}),e(E,{label:"实验交付物要求"},{default:t(i=>[V("ol",null,[(n(!0),f(j,null,B(i.row.deliverableRequirementList.length,d=>(n(),f("li",{key:d},G(i.row.deliverableRequirementList[d-1].name),1))),128))])]),_:1}),e(E,{label:"实验参考链接"},{default:t(i=>[V("ol",null,[(n(!0),f(j,null,B(i.row.referenceLinkList.length,d=>(n(),f("li",{key:d},G(i.row.referenceLinkList[d-1].name+"："+i.row.referenceLinkList[d-1].url),1))),128))])]),_:1}),e(E,{label:"实验参考指导"},{default:t(i=>[V("div",null,[V("ol",null,[(n(!0),f(j,null,B(i.row.referenceFileList.length,d=>(n(),f("li",{key:d},G(i.row.referenceFileList[d-1].originFilename),1))),128))])]),V("div",Yt,[e(de,{class:"upload-demo",headers:g.value,action:"/dev-api/task_template/task_template_add_resource/"+L.value+"/"+i.row.id,"on-success":w,"show-file-list":!1},{default:t(()=>[e(K,{type:"primary",size:"small"},{default:t(()=>b[3]||(b[3]=[x("上传",-1)])),_:1,__:[3]})]),_:2},1032,["headers","action"])])]),_:1}),e(E,{prop:"",label:"操作",width:"100px"},{default:t(i=>[e(K,{link:"",type:"primary",size:"small",icon:H(Pe),onClick:d=>o(i.$index)},null,8,["icon","onClick"]),e(I,{title:"确定删除吗?",onConfirm:d=>c(i.row.id)},{reference:t(()=>[e(K,{link:"",type:"danger",size:"small",icon:H(fe)},null,8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),V("div",Zt,[e(Y,{style:{"min-height":"280px"},shadow:"never"},{header:t(()=>[P.value?(n(),f("div",tl,b[5]||(b[5]=[V("span",null,"编辑实验",-1)]))):(n(),f("div",el,b[4]||(b[4]=[V("span",null,"添加实验",-1)])))]),default:t(()=>[V("div",null,[e(ae,{"label-width":"100px"},{default:t(()=>[e(X,{label:"实验设备：",prop:"taskDevice"},{default:t(()=>[e(F,{modelValue:v.value,"onUpdate:modelValue":b[0]||(b[0]=i=>v.value=i),onChange:b[1]||(b[1]=i=>_()),disabled:P.value},{default:t(()=>[e(u,{label:0},{default:t(()=>b[6]||(b[6]=[x("无设备",-1)])),_:1,__:[6]}),(n(!0),f(j,null,B(l.value,i=>(n(),U(u,{label:i.id},{default:t(()=>[x(G(i.name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),e(T),v.value==0&&L.value?(n(),U(Ft,{key:Date.now().toString(),courseId:L.value,isEdit:P.value,oldTaskTemplate:Q.value,onAddSuccess:y,onExitUpdate:N},null,8,["courseId","isEdit","oldTaskTemplate"])):A("",!0),v.value==1&&O.value&&L.value?(n(),U(Kt,{key:Date.now().toString(),device:O.value,courseId:L.value,isEdit:P.value,oldTaskTemplate:Q.value,onAddSuccess:y,onExitUpdate:N},null,8,["device","courseId","isEdit","oldTaskTemplate"])):A("",!0)]),_:1})]),e(C,{class:"bottom-row"},{default:t(()=>[e(K,{onClick:h},{default:t(()=>b[7]||(b[7]=[x("上一步",-1)])),_:1,__:[7]}),e(K,{type:"primary",onClick:b[2]||(b[2]=i=>z())},{default:t(()=>b[8]||(b[8]=[x("下一步",-1)])),_:1,__:[8]})]),_:1})])}}});const al=re(ll,[["__scopeId","data-v-347100fa"]]),nl={id:"pane-sixth",class:"pane",key:"5"},ol={style:{border:"1px solid #ccc"}},sl=te({__name:"six",props:{courseId:Number},emits:["nextStep","lastStep"],setup(M,{emit:J}){const p=M,g=J,L=w=>{g("nextStep",w)},k=()=>{g("lastStep")},D=r(0);le(()=>{D.value=p.courseId,y(D.value)}),r();const R=r({id:null,name:"",introduction:"",introduce:"",target:"",cover:"",completion:null,guidance:"",third:0}),$=r("default"),h=Be(),v=r(""),O={excludeKeys:["bold","group-video","fullScreen"]},_={placeholder:"请输入内容...",MENU_CONF:{}},l=w=>{h.value=w};_.MENU_CONF.uploadImage={server:"/dev-api/files/wdupimage",timeout:5*1e3,fieldName:"file",metaWithUrl:!0,maxFileSize:10*1024*1024,base64LimitSize:5*1024,onBeforeUpload(w){return w},onProgress(w){},onSuccess(w,c){},onFailed(w,c){alert(c.message)},onError(w,c,z){alert(c.message),console.error("onError",w,c,z)}};const s=()=>{document.getElementById("editor-content-view").innerHTML=v.value},y=w=>{Je(w).then(c=>{c.state==200?v.value=c.data:q.error("获取案例指导异常")})},N=()=>{R.value.guidance=v.value;let w=Object.assign({},R.value);et(D.value,w).then(c=>{if(c.state==200){let z=c.data.completion;L(z)}else q.error(c.message)})};return(w,c)=>{const z=oe,P=se;return n(),f("div",nl,[V("div",ol,[e(H(Ye),{style:{"border-bottom":"1px solid #ccc"},editor:h.value,defaultConfig:O,mode:$.value},null,8,["editor","mode"]),e(H(Ze),{style:{height:"500px","overflow-y":"hidden"},modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=Q=>v.value=Q),defaultConfig:_,mode:$.value,onOnCreated:l,onOnChange:s},null,8,["modelValue","mode"])]),e(P,{class:"bottom-row"},{default:t(()=>[e(z,{onClick:k},{default:t(()=>c[2]||(c[2]=[x("上一步",-1)])),_:1,__:[2]}),e(z,{type:"primary",onClick:c[1]||(c[1]=Q=>N())},{default:t(()=>c[3]||(c[3]=[x("下一步",-1)])),_:1,__:[3]})]),_:1}),c[4]||(c[4]=V("div",{id:"editor-content-view",class:"editor-content-view clearfix"},null,-1))])}}});const ul=re(sl,[["__scopeId","data-v-c328422d"]]),il={id:"pane-seventh",class:"pane",key:"6"},rl={style:{display:"flex","flex-direction":"column"}},dl={style:{padding:"20px"}},ml=te({__name:"seven",props:{courseId:Number},emits:["done","lastStep"],setup(M,{emit:J}){const p=M,g=J,L=()=>{g("done")},k=()=>{g("lastStep")},D=r(0);le(()=>{D.value=p.courseId,O(D.value)});const R=r({"x-access-token":localStorage.getItem("x-access-token"),"x-access-type":localStorage.getItem("x-access-type")}),$=r([]),h=l=>l.size/1024/1024/1024>1?(q({showClose:!0,message:"文件最大不能超过1GB",type:"success"}),!1):!0,v=l=>{l.state==200&&($.value=l.data)},O=async l=>{await st(l).then(s=>{s.state==200?$.value=s.data:q.error("获取资源包失败"+s.message)})},_=l=>{ut(D.value,l).then(s=>{s.state==200?$.value=s.data:q.error(s.message)})};return(l,s)=>{const y=xe("upload-filled"),N=Le,w=be,c=oe,z=we,P=se;return n(),f("div",il,[V("div",rl,[V("div",dl,[e(w,{class:"upload-demo",drag:"",multiple:"",action:"/dev-api/content/upload_pkg/"+D.value,headers:R.value,"before-upload":h,"on-success":v},{tip:t(()=>s[0]||(s[0]=[V("div",{class:"el-upload__tip"}," 单个文件最大不超过100MB。 ",-1)])),default:t(()=>[e(N,{class:"el-icon--upload"},{default:t(()=>[e(y)]),_:1}),s[1]||(s[1]=V("div",{class:"el-upload__text"},[x(" Drop file here or "),V("em",null,"click to upload")],-1))]),_:1,__:[1]},8,["action","headers"])]),V("div",null,[(n(!0),f(j,null,B($.value.length,Q=>(n(),U(P,{style:{"text-align":"left"}},{default:t(()=>[e(c,{type:"primary",icon:H(Ge),link:""},{default:t(()=>[x(G($.value[Q-1].originFilename),1)]),_:2},1032,["icon"]),e(z,{title:"确定删除吗?",onConfirm:o=>_($.value[Q-1].id)},{reference:t(()=>[e(c,{link:"",type:"danger",size:"small",icon:H(fe)},null,8,["icon"])]),_:2},1032,["onConfirm"])]),_:2},1024))),256))])]),e(P,{class:"bottom-row"},{default:t(()=>[e(c,{onClick:k},{default:t(()=>s[2]||(s[2]=[x("上一步",-1)])),_:1,__:[2]}),e(c,{type:"primary",onClick:L},{default:t(()=>s[3]||(s[3]=[x("完成",-1)])),_:1,__:[3]})]),_:1})])}}});const pl=re(ml,[["__scopeId","data-v-476c01dc"]]),vl={style:{"margin-top":"40px"}},xl=te({__name:"index",setup(M){const J=r({id:null,name:"",introduction:"",introduce:"",target:"",cover:"",completion:null,guidance:"",third:1}),p=Ae(),g=r(0),L=r(0),k=r(0),D=_=>{_>k.value+1||(L.value=_)},R=_=>{L.value=_+1,_>k.value&&(k.value=_)},$=()=>{L.value-=1},h=_=>{g.value=_},v=_=>{ke(_).then(l=>{l.state==200?(J.value=l.data,L.value=J.value.completion+1,k.value=J.value.completion):q.error(l.message)})},O=()=>{it(g.value).then(_=>{_.state==200?Qe.push({name:p.meta.parentName}):q.error(_.message)})};return le(()=>{g.value=p.params.courseId,v(g.value)}),(_,l)=>{const s=Me,y=He,N=qe,w=se;return n(),f("div",null,[e(w,null,{default:t(()=>[e(N,{span:24},{default:t(()=>[e(y,{active:L.value,simple:""},{default:t(()=>[e(s,{title:"基本信息",onClick:l[0]||(l[0]=c=>D(0))}),e(s,{title:"上传封面",onClick:l[1]||(l[1]=c=>D(1))}),e(s,{title:"知识点",onClick:l[2]||(l[2]=c=>D(2))}),e(s,{title:"课程设计",onClick:l[3]||(l[3]=c=>D(3))}),e(s,{title:"实验设计",onClick:l[4]||(l[4]=c=>D(4))}),e(s,{title:"课程概览",onClick:l[5]||(l[5]=c=>D(5))}),e(s,{title:"附件资源",onClick:l[6]||(l[6]=c=>D(6))})]),_:1},8,["active"])]),_:1})]),_:1}),V("div",vl,[L.value==0?(n(),U(mt,{key:0,courseId:g.value,onNextStep:R,onCreated:h},null,8,["courseId"])):A("",!0),L.value==1?(n(),U(ft,{key:1,courseId:g.value,onLastStep:$,onNextStep:R},null,8,["courseId"])):A("",!0),L.value==2?(n(),U(xt,{key:2,courseId:g.value,onLastStep:$,onNextStep:R},null,8,["courseId"])):A("",!0),L.value==3?(n(),U(It,{key:3,courseId:g.value,onLastStep:$,onNextStep:R},null,8,["courseId"])):A("",!0),L.value==4?(n(),U(al,{key:4,courseId:g.value,onLastStep:$,onNextStep:R},null,8,["courseId"])):A("",!0),L.value==5?(n(),U(ul,{key:5,courseId:g.value,onLastStep:$,onNextStep:R},null,8,["courseId"])):A("",!0),L.value>=6?(n(),U(pl,{key:6,courseId:g.value,onLastStep:$,onDone:O},null,8,["courseId"])):A("",!0)])])}}});export{xl as default};
