import{u as G,b as d,o as H,a as _,c as g,i as s,g as l,w as a,t as p,f as r,F as B,j as I,s as J,x as K,a8 as Q,q as m,bq as X,n as Y,$ as Z,ap as ee,au as te,N as oe,O as le,M as ae,R as ne}from"./index-8f9ccc2f.js";import{i as se,j as re,k as ie,l as de,m as pe}from"./index-9020ea85.js";import{a as L,b as j}from"./interfaces-2a72a038.js";import{l as z}from"./lodash-56abab90.js";import{_ as me}from"./xComponet-93f6ef88.js";/* empty css                   */import"./tracneline.vue_vue_type_script_setup_true_lang-e84559dc.js";import"./stuLab-819536eb.js";import"./browser-19b77043.js";import"./marked.esm-fed877e7.js";import"./katex-4b21be29.js";import"./purify.es-9c590e79.js";/* empty css                  *//* empty css                  */const ue={class:"bg-gray-50 min-h-screen"},ce={class:"bg-white border-b border-l border-gray-200 sticky top-0 z-50"},_e={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},fe={class:"flex justify-between items-center h-16"},be={class:"flex items-center space-x-2"},ve={class:"w-full h-full min-h-screen p-6 border-l"},ge={class:"flex flex-row justify-between p-4 bg-gray-100 border border-gray-300"},ke={class:"flex justify-end mt-2"},ye={class:"p-8"},$e={__name:"labStepViewMange",setup(Ce){const h=G(),k=d(h.params.blockId),y=d(h.params.labId),f=d({visible:!1,title:"添加组件模版"}),b=d(""),c=d([]),D=d([]),C=d({}),E=d(null),M=t=>{w();let e=z.cloneDeep(c.value);e.forEach(o=>{o.component=o.componentId}),ie(e).then(o=>{o.state==200&&(v(),T(t))})},T=t=>{E.value[t].hide()},N=t=>{de(t).then(e=>{e.state==200&&v()})},P=()=>{f.value.visible=!0},$=t=>{pe(k.value,t.id).then(e=>{e.state==200&&v()})},v=()=>{se(k.value).then(t=>{if(t.state==200){let e=t.data||[];c.value=e,w()}})},w=()=>{let t=c.value;t.sort((e,o)=>Number.parseInt(e.order)-Number.parseInt(o.order)),c.value=t},O=()=>{re(y.value).then(t=>{if(t.state==200){let e=t.data||[];e.forEach(x=>{R(x)}),D.value=e,C.value=z._.groupBy(e,"type");let o=Object.keys(C.value);o.length&&(b.value=o[0])}else J.error(t.message)})},R=t=>{t.id=t.componentId};return H(()=>{O(),v()}),(t,e)=>{const o=K,x=Z,U=ee,q=te,V=oe,S=le,F=ae,A=ne,W=Q;return _(),g("div",ue,[s("header",ce,[s("div",_e,[s("div",fe,[s("div",be,[l(o,{type:"primary",onClick:P},{default:a(()=>e[2]||(e[2]=[m("添加模板",-1)])),_:1,__:[2]})]),s("div",null,[s("span",null," 实验模板步骤管理 - 实验id: "+p(r(y))+" - 实验步骤 blockId: "+p(r(k)),1)])])])]),s("div",ve,[(_(!0),g(B,null,I(r(c),(n,u)=>(_(),g("div",{key:u,class:"mb-4 border border-gray-200 bg-white"},[s("div",ge,[s("div",null,p(n.order),1),s("div",null,p(n.labComponentVo.name)+" -- "+p(r(L)(n.labComponentVo.type))+" -- "+p(r(j)(n.labComponentVo.stage)),1),s("div",null,[l(U,{title:"排序",ref_for:!0,ref_key:"orderPopRef",ref:E},{reference:a(()=>[l(o,{size:"small"},{default:a(()=>e[3]||(e[3]=[m("排序",-1)])),_:1,__:[3]})]),default:a(()=>[s("div",null,[l(x,{modelValue:n.order,"onUpdate:modelValue":i=>n.order=i,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"]),s("div",ke,[l(o,{link:"",size:"small",onClick:i=>T(u)},{default:a(()=>e[4]||(e[4]=[m("取消",-1)])),_:2,__:[4]},1032,["onClick"]),l(o,{size:"small",type:"primary",onClick:i=>M(u)},{default:a(()=>e[5]||(e[5]=[m("确定",-1)])),_:2,__:[5]},1032,["onClick"])])])]),_:2},1536),l(q,{width:"200px",title:"确认删除这个组件吗?","confirm-button-text":"确定","cancel-button-text":"取消",onConfirm:i=>N(n.id)},{reference:a(()=>[l(o,{size:"small",type:"danger"},{default:a(()=>e[6]||(e[6]=[m("删除",-1)])),_:1,__:[6]})]),_:2},1032,["onConfirm"])])]),s("div",ye,[l(me,{labId:r(y),item:n.labComponentVo},null,8,["labId","item"])])]))),128))]),l(W,{modelValue:r(f).visible,"onUpdate:modelValue":e[1]||(e[1]=n=>r(f).visible=n),title:r(f).title},{default:a(()=>[l(A,{modelValue:r(b),"onUpdate:modelValue":e[0]||(e[0]=n=>X(b)?b.value=n:null)},{default:a(()=>[(_(!0),g(B,null,I(r(C),(n,u)=>(_(),Y(F,{label:r(L)(u),name:u},{default:a(()=>[l(S,{data:n},{default:a(()=>[l(V,{prop:"name"}),l(V,{prop:"stage"},{default:a(i=>[m(p(r(j)(i.row.stage)),1)]),_:1}),l(V,{width:"100px"},{default:a(({row:i})=>[l(o,{size:"small",onClick:xe=>$(i)},{default:a(()=>e[7]||(e[7]=[m("添加",-1)])),_:2,__:[7]},1032,["onClick"])]),_:1})]),_:2},1032,["data"])]),_:2},1032,["label","name"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])])}}};export{$e as default};
